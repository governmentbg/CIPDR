import{aa as isObjectLike,ab as baseGetTag,ac as Symbol$1,ad as isArray,ae as isObject,af as isArrayLike,ag as arrayLikeKeys,ah as baseKeys,ai as memoize,aj as isArguments,ak as setToString,al as overRest,am as copyObject,an as keysIn,ao as getPrototype,ap as cloneArrayBuffer,aq as cloneTypedArray,ar as getTag,as as nodeUtil,at as baseUnary,au as copyArray,av as isBuffer,aw as cloneBuffer,ax as initCloneObject,ay as Stack,az as assignValue,aA as MapCache,aB as eq,aC as Uint8Array,aD as isTypedArray,aE as isLength,aF as isIndex,aG as identity,aH as baseFor,aI as root,aJ as baseRest,aK as isIterateeCall,aL as baseAssignValue,aM as Set,aN as isArrayLikeObject,aO as constant,z as isFunction,aP as isEmpty,aQ as merge}from"./mermaid-f185fde2.js";var symbolTag$3="[object Symbol]";function isSymbol(e){return"symbol"==typeof e||isObjectLike(e)&&baseGetTag(e)==symbolTag$3}function arrayMap(e,n){for(var t=-1,r=null==e?0:e.length,a=Array(r);++t<r;)a[t]=n(e[t],t,e);return a}var INFINITY$3=1/0,symbolProto$2=Symbol$1?Symbol$1.prototype:void 0,symbolToString=symbolProto$2?symbolProto$2.toString:void 0;function baseToString(e){if("string"==typeof e)return e;if(isArray(e))return arrayMap(e,baseToString)+"";if(isSymbol(e))return symbolToString?symbolToString.call(e):"";var n=e+"";return"0"==n&&1/e==-INFINITY$3?"-0":n}var reWhitespace=/\s/;function trimmedEndIndex(e){for(var n=e.length;n--&&reWhitespace.test(e.charAt(n)););return n}var reTrimStart=/^\s+/;function baseTrim(e){return e&&e.slice(0,trimmedEndIndex(e)+1).replace(reTrimStart,"")}var NAN=NaN,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;function toNumber(e){if("number"==typeof e)return e;if(isSymbol(e))return NAN;if(isObject(e)&&(n="function"==typeof e.valueOf?e.valueOf():e,e=isObject(n)?n+"":n),"string"!=typeof e)return 0===e?e:+e;e=baseTrim(e);var n=reIsBinary.test(e);return n||reIsOctal.test(e)?freeParseInt(e.slice(2),n?2:8):reIsBadHex.test(e)?NAN:+e}var INFINITY$2=1/0,MAX_INTEGER=17976931348623157e292;function toFinite(e){return e?(e=toNumber(e))===INFINITY$2||e===-INFINITY$2?(e<0?-1:1)*MAX_INTEGER:e==e?e:0:0===e?e:0}function toInteger(e){var e=toFinite(e),n=e%1;return e==e?n?e-n:e:0}function noop(){}function arrayEach(e,n){for(var t=-1,r=null==e?0:e.length;++t<r&&!1!==n(e[t],t,e););return e}function baseFindIndex(e,n,t,r){for(var a=e.length,o=t+(r?1:-1);r?o--:++o<a;)if(n(e[o],o,e))return o;return-1}function baseIsNaN(e){return e!=e}function strictIndexOf(e,n,t){for(var r=t-1,a=e.length;++r<a;)if(e[r]===n)return r;return-1}function baseIndexOf(e,n,t){return n==n?strictIndexOf(e,n,t):baseFindIndex(e,baseIsNaN,t)}function arrayIncludes(e,n){return!!(null==e?0:e.length)&&-1<baseIndexOf(e,n,0)}function keys(e){return(isArrayLike(e)?arrayLikeKeys:baseKeys)(e)}var reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;function isKey(e,n){if(isArray(e))return!1;var t=typeof e;return!("number"!=t&&"symbol"!=t&&"boolean"!=t&&null!=e&&!isSymbol(e))||(reIsPlainProp.test(e)||!reIsDeepProp.test(e)||null!=n&&e in Object(n))}var MAX_MEMOIZE_SIZE=500;function memoizeCapped(e){var e=memoize(e,function(e){return n.size===MAX_MEMOIZE_SIZE&&n.clear(),e}),n=e.cache;return e}var rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=memoizeCapped(function(e){var a=[];return 46===e.charCodeAt(0)&&a.push(""),e.replace(rePropName,function(e,n,t,r){a.push(t?r.replace(reEscapeChar,"$1"):n||e)}),a});const stringToPath$1=stringToPath;function toString(e){return null==e?"":baseToString(e)}function castPath(e,n){return isArray(e)?e:isKey(e,n)?[e]:stringToPath$1(toString(e))}var INFINITY$1=1/0;function toKey(e){if("string"==typeof e||isSymbol(e))return e;var n=e+"";return"0"==n&&1/e==-INFINITY$1?"-0":n}function baseGet(e,n){for(var t=0,r=(n=castPath(n,e)).length;null!=e&&t<r;)e=e[toKey(n[t++])];return t&&t==r?e:void 0}function get(e,n,t){e=null==e?void 0:baseGet(e,n);return void 0===e?t:e}function arrayPush(e,n){for(var t=-1,r=n.length,a=e.length;++t<r;)e[a+t]=n[t];return e}var spreadableSymbol=Symbol$1?Symbol$1.isConcatSpreadable:void 0;function isFlattenable(e){return isArray(e)||isArguments(e)||!!(spreadableSymbol&&e&&e[spreadableSymbol])}function baseFlatten(e,n,t,r,a){var o=-1,i=e.length;for(t=t||isFlattenable,a=a||[];++o<i;){var s=e[o];0<n&&t(s)?1<n?baseFlatten(s,n-1,t,r,a):arrayPush(a,s):r||(a[a.length]=s)}return a}function flatten(e){return(null==e?0:e.length)?baseFlatten(e,1):[]}function flatRest(e){return setToString(overRest(e,void 0,flatten),e+"")}function arrayReduce(e,n,t,r){var a=-1,o=null==e?0:e.length;for(r&&o&&(t=e[++a]);++a<o;)t=n(t,e[a],a,e);return t}function baseAssign(e,n){return e&&copyObject(n,keys(n),e)}function baseAssignIn(e,n){return e&&copyObject(n,keysIn(n),e)}function arrayFilter(e,n){for(var t=-1,r=null==e?0:e.length,a=0,o=[];++t<r;){var i=e[t];n(i,t,e)&&(o[a++]=i)}return o}function stubArray(){return[]}var objectProto$5=Object.prototype,propertyIsEnumerable=objectProto$5.propertyIsEnumerable,nativeGetSymbols$1=Object.getOwnPropertySymbols,getSymbols=nativeGetSymbols$1?function(n){return null==n?[]:(n=Object(n),arrayFilter(nativeGetSymbols$1(n),function(e){return propertyIsEnumerable.call(n,e)}))}:stubArray;const getSymbols$1=getSymbols;function copySymbols(e,n){return copyObject(e,getSymbols$1(e),n)}var nativeGetSymbols=Object.getOwnPropertySymbols,getSymbolsIn=nativeGetSymbols?function(e){for(var n=[];e;)arrayPush(n,getSymbols$1(e)),e=getPrototype(e);return n}:stubArray;const getSymbolsIn$1=getSymbolsIn;function copySymbolsIn(e,n){return copyObject(e,getSymbolsIn$1(e),n)}function baseGetAllKeys(e,n,t){n=n(e);return isArray(e)?n:arrayPush(n,t(e))}function getAllKeys(e){return baseGetAllKeys(e,keys,getSymbols$1)}function getAllKeysIn(e){return baseGetAllKeys(e,keysIn,getSymbolsIn$1)}var objectProto$4=Object.prototype,hasOwnProperty$4=objectProto$4.hasOwnProperty;function initCloneArray(e){var n=e.length,t=new e.constructor(n);return n&&"string"==typeof e[0]&&hasOwnProperty$4.call(e,"index")&&(t.index=e.index,t.input=e.input),t}function cloneDataView(e,n){n=n?cloneArrayBuffer(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}var reFlags=/\w*$/;function cloneRegExp(e){var n=new e.constructor(e.source,reFlags.exec(e));return n.lastIndex=e.lastIndex,n}var symbolProto$1=Symbol$1?Symbol$1.prototype:void 0,symbolValueOf$1=symbolProto$1?symbolProto$1.valueOf:void 0;function cloneSymbol(e){return symbolValueOf$1?Object(symbolValueOf$1.call(e)):{}}var boolTag$2="[object Boolean]",dateTag$2="[object Date]",mapTag$3="[object Map]",numberTag$2="[object Number]",regexpTag$2="[object RegExp]",setTag$3="[object Set]",stringTag$2="[object String]",symbolTag$2="[object Symbol]",arrayBufferTag$2="[object ArrayBuffer]",dataViewTag$2="[object DataView]",float32Tag$1="[object Float32Array]",float64Tag$1="[object Float64Array]",int8Tag$1="[object Int8Array]",int16Tag$1="[object Int16Array]",int32Tag$1="[object Int32Array]",uint8Tag$1="[object Uint8Array]",uint8ClampedTag$1="[object Uint8ClampedArray]",uint16Tag$1="[object Uint16Array]",uint32Tag$1="[object Uint32Array]";function initCloneByTag(e,n,t){var r=e.constructor;switch(n){case arrayBufferTag$2:return cloneArrayBuffer(e);case boolTag$2:case dateTag$2:return new r(+e);case dataViewTag$2:return cloneDataView(e,t);case float32Tag$1:case float64Tag$1:case int8Tag$1:case int16Tag$1:case int32Tag$1:case uint8Tag$1:case uint8ClampedTag$1:case uint16Tag$1:case uint32Tag$1:return cloneTypedArray(e,t);case mapTag$3:return new r;case numberTag$2:case stringTag$2:return new r(e);case regexpTag$2:return cloneRegExp(e);case setTag$3:return new r;case symbolTag$2:return cloneSymbol(e)}}var mapTag$2="[object Map]";function baseIsMap(e){return isObjectLike(e)&&getTag(e)==mapTag$2}var nodeIsMap=nodeUtil&&nodeUtil.isMap,isMap=nodeIsMap?baseUnary(nodeIsMap):baseIsMap;const isMap$1=isMap;var setTag$2="[object Set]";function baseIsSet(e){return isObjectLike(e)&&getTag(e)==setTag$2}var nodeIsSet=nodeUtil&&nodeUtil.isSet,isSet=nodeIsSet?baseUnary(nodeIsSet):baseIsSet;const isSet$1=isSet;var CLONE_DEEP_FLAG$1=1,CLONE_FLAT_FLAG=2,CLONE_SYMBOLS_FLAG$1=4,argsTag$1="[object Arguments]",arrayTag$1="[object Array]",boolTag$1="[object Boolean]",dateTag$1="[object Date]",errorTag$1="[object Error]",funcTag="[object Function]",genTag="[object GeneratorFunction]",mapTag$1="[object Map]",numberTag$1="[object Number]",objectTag$1="[object Object]",regexpTag$1="[object RegExp]",setTag$1="[object Set]",stringTag$1="[object String]",symbolTag$1="[object Symbol]",weakMapTag="[object WeakMap]",arrayBufferTag$1="[object ArrayBuffer]",dataViewTag$1="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",cloneableTags={};function baseClone(t,r,a,e,n,o){var i,s=r&CLONE_DEEP_FLAG$1,u=r&CLONE_FLAT_FLAG,c=r&CLONE_SYMBOLS_FLAG$1;if(void 0!==(i=a?n?a(t,e,n,o):a(t):i))return i;if(!isObject(t))return t;e=isArray(t);if(e){if(i=initCloneArray(t),!s)return copyArray(t,i)}else{var d=getTag(t),f=d==funcTag||d==genTag;if(isBuffer(t))return cloneBuffer(t,s);if(d==objectTag$1||d==argsTag$1||f&&!n){if(i=u||f?{}:initCloneObject(t),!s)return u?copySymbolsIn(t,baseAssignIn(i,t)):copySymbols(t,baseAssign(i,t))}else{if(!cloneableTags[d])return n?t:{};i=initCloneByTag(t,d,s)}}f=(o=o||new Stack).get(t);if(f)return f;o.set(t,i),isSet$1(t)?t.forEach(function(e){i.add(baseClone(e,r,a,e,t,o))}):isMap$1(t)&&t.forEach(function(e,n){i.set(n,baseClone(e,r,a,n,t,o))});var l=e?void 0:(c?u?getAllKeysIn:getAllKeys:u?keysIn:keys)(t);return arrayEach(l||t,function(e,n){l&&(e=t[n=e]),assignValue(i,n,baseClone(e,r,a,n,t,o))}),i}cloneableTags[argsTag$1]=cloneableTags[arrayTag$1]=cloneableTags[arrayBufferTag$1]=cloneableTags[dataViewTag$1]=cloneableTags[boolTag$1]=cloneableTags[dateTag$1]=cloneableTags[float32Tag]=cloneableTags[float64Tag]=cloneableTags[int8Tag]=cloneableTags[int16Tag]=cloneableTags[int32Tag]=cloneableTags[mapTag$1]=cloneableTags[numberTag$1]=cloneableTags[objectTag$1]=cloneableTags[regexpTag$1]=cloneableTags[setTag$1]=cloneableTags[stringTag$1]=cloneableTags[symbolTag$1]=cloneableTags[uint8Tag]=cloneableTags[uint8ClampedTag]=cloneableTags[uint16Tag]=cloneableTags[uint32Tag]=!0,cloneableTags[errorTag$1]=cloneableTags[funcTag]=cloneableTags[weakMapTag]=!1;var CLONE_DEEP_FLAG=1,CLONE_SYMBOLS_FLAG=4;function cloneDeep(e){return baseClone(e,CLONE_DEEP_FLAG|CLONE_SYMBOLS_FLAG)}var HASH_UNDEFINED="__lodash_hash_undefined__";function setCacheAdd(e){return this.__data__.set(e,HASH_UNDEFINED),this}function setCacheHas(e){return this.__data__.has(e)}function SetCache(e){var n=-1,t=null==e?0:e.length;for(this.__data__=new MapCache;++n<t;)this.add(e[n])}function arraySome(e,n){for(var t=-1,r=null==e?0:e.length;++t<r;)if(n(e[t],t,e))return!0;return!1}function cacheHas(e,n){return e.has(n)}SetCache.prototype.add=SetCache.prototype.push=setCacheAdd,SetCache.prototype.has=setCacheHas;var COMPARE_PARTIAL_FLAG$5=1,COMPARE_UNORDERED_FLAG$3=2;function equalArrays(e,n,t,r,a,o){var i=t&COMPARE_PARTIAL_FLAG$5,s=e.length,u=n.length;if(s!=u&&!(i&&s<u))return!1;var u=o.get(e),c=o.get(n);if(u&&c)return u==n&&c==e;var d=-1,f=!0,l=t&COMPARE_UNORDERED_FLAG$3?new SetCache:void 0;for(o.set(e,n),o.set(n,e);++d<s;){var h,g=e[d],b=n[d];if(void 0!==(h=r?i?r(b,g,d,n,e,o):r(g,b,d,e,n,o):h)){if(h)continue;f=!1;break}if(l){if(!arraySome(n,function(e,n){if(!cacheHas(l,n)&&(g===e||a(g,e,t,r,o)))return l.push(n)})){f=!1;break}}else if(g!==b&&!a(g,b,t,r,o)){f=!1;break}}return o.delete(e),o.delete(n),f}function mapToArray(e){var t=-1,r=Array(e.size);return e.forEach(function(e,n){r[++t]=[n,e]}),r}function setToArray(e){var n=-1,t=Array(e.size);return e.forEach(function(e){t[++n]=e}),t}var COMPARE_PARTIAL_FLAG$4=1,COMPARE_UNORDERED_FLAG$2=2,boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",mapTag="[object Map]",numberTag="[object Number]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",symbolTag="[object Symbol]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",symbolProto=Symbol$1?Symbol$1.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;function equalByTag(e,n,t,r,a,o,i){switch(t){case dataViewTag:if(e.byteLength!=n.byteLength||e.byteOffset!=n.byteOffset)return!1;e=e.buffer,n=n.buffer;case arrayBufferTag:return e.byteLength==n.byteLength&&o(new Uint8Array(e),new Uint8Array(n))?!0:!1;case boolTag:case dateTag:case numberTag:return eq(+e,+n);case errorTag:return e.name==n.name&&e.message==n.message;case regexpTag:case stringTag:return e==n+"";case mapTag:var s=mapToArray;case setTag:s=s||setToArray;if(e.size!=n.size&&!(r&COMPARE_PARTIAL_FLAG$4))return!1;var u=i.get(e);if(u)return u==n;r|=COMPARE_UNORDERED_FLAG$2,i.set(e,n);u=equalArrays(s(e),s(n),r,a,o,i);return i.delete(e),u;case symbolTag:if(symbolValueOf)return symbolValueOf.call(e)==symbolValueOf.call(n)}return!1}var COMPARE_PARTIAL_FLAG$3=1,objectProto$3=Object.prototype,hasOwnProperty$3=objectProto$3.hasOwnProperty;function equalObjects(e,n,t,r,a,o){var i=t&COMPARE_PARTIAL_FLAG$3,s=getAllKeys(e),u=s.length;if(u!=getAllKeys(n).length&&!i)return!1;for(var c=u;c--;){var d=s[c];if(!(i?d in n:hasOwnProperty$3.call(n,d)))return!1}var f=o.get(e),l=o.get(n);if(f&&l)return f==n&&l==e;for(var h=!0,g=(o.set(e,n),o.set(n,e),i);++c<u;){var b,p=e[d=s[c]],v=n[d];if(!(void 0===(b=r?i?r(v,p,d,n,e,o):r(p,v,d,e,n,o):b)?p===v||a(p,v,t,r,o):b)){h=!1;break}g=g||"constructor"==d}return h&&!g&&(f=e.constructor)!=(l=n.constructor)&&"constructor"in e&&"constructor"in n&&!("function"==typeof f&&f instanceof f&&"function"==typeof l&&l instanceof l)&&(h=!1),o.delete(e),o.delete(n),h}var COMPARE_PARTIAL_FLAG$2=1,argsTag="[object Arguments]",arrayTag="[object Array]",objectTag="[object Object]",objectProto$2=Object.prototype,hasOwnProperty$2=objectProto$2.hasOwnProperty;function baseIsEqualDeep(e,n,t,r,a,o){var i=isArray(e),s=isArray(n),u=i?arrayTag:getTag(e),s=s?arrayTag:getTag(n),c=(u=u==argsTag?objectTag:u)==objectTag,d=(s=s==argsTag?objectTag:s)==objectTag,s=u==s;if(s&&isBuffer(e)){if(!isBuffer(n))return!1;c=!(i=!0)}if(s&&!c)return o=o||new Stack,i||isTypedArray(e)?equalArrays(e,n,t,r,a,o):equalByTag(e,n,u,t,r,a,o);if(!(t&COMPARE_PARTIAL_FLAG$2)){i=c&&hasOwnProperty$2.call(e,"__wrapped__"),u=d&&hasOwnProperty$2.call(n,"__wrapped__");if(i||u)return a(i?e.value():e,u?n.value():n,t,r,o=o||new Stack)}return!!s&&equalObjects(e,n,t,r,a,o=o||new Stack)}function baseIsEqual(e,n,t,r,a){return e===n||(null==e||null==n||!isObjectLike(e)&&!isObjectLike(n)?e!=e&&n!=n:baseIsEqualDeep(e,n,t,r,baseIsEqual,a))}var COMPARE_PARTIAL_FLAG$1=1,COMPARE_UNORDERED_FLAG$1=2;function baseIsMatch(e,n,t,r){var a=t.length,o=a,i=!r;if(null==e)return!o;for(e=Object(e);a--;){var s=t[a];if(i&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++a<o;){var u=(s=t[a])[0],c=e[u],d=s[1];if(i&&s[2]){if(void 0===c&&!(u in e))return!1}else{var f,l=new Stack;if(!(void 0===(f=r?r(c,d,u,e,n,l):f)?baseIsEqual(d,c,COMPARE_PARTIAL_FLAG$1|COMPARE_UNORDERED_FLAG$1,r,l):f))return!1}}return!0}function isStrictComparable(e){return e==e&&!isObject(e)}function getMatchData(e){for(var n=keys(e),t=n.length;t--;){var r=n[t],a=e[r];n[t]=[r,a,isStrictComparable(a)]}return n}function matchesStrictComparable(n,t){return function(e){return null!=e&&(e[n]===t&&(void 0!==t||n in Object(e)))}}function baseMatches(n){var t=getMatchData(n);return 1==t.length&&t[0][2]?matchesStrictComparable(t[0][0],t[0][1]):function(e){return e===n||baseIsMatch(e,n,t)}}function baseHasIn(e,n){return null!=e&&n in Object(e)}function hasPath(e,n,t){for(var r=-1,a=(n=castPath(n,e)).length,o=!1;++r<a;){var i=toKey(n[r]);if(!(o=null!=e&&t(e,i)))break;e=e[i]}return o||++r!=a?o:!!(a=null==e?0:e.length)&&isLength(a)&&isIndex(i,a)&&(isArray(e)||isArguments(e))}function hasIn(e,n){return null!=e&&hasPath(e,n,baseHasIn)}var COMPARE_PARTIAL_FLAG=1,COMPARE_UNORDERED_FLAG=2;function baseMatchesProperty(t,r){return isKey(t)&&isStrictComparable(r)?matchesStrictComparable(toKey(t),r):function(e){var n=get(e,t);return void 0===n&&n===r?hasIn(e,t):baseIsEqual(r,n,COMPARE_PARTIAL_FLAG|COMPARE_UNORDERED_FLAG)}}function baseProperty(n){return function(e){return null==e?void 0:e[n]}}function basePropertyDeep(n){return function(e){return baseGet(e,n)}}function property(e){return isKey(e)?baseProperty(toKey(e)):basePropertyDeep(e)}function baseIteratee(e){return"function"==typeof e?e:null==e?identity:"object"==typeof e?isArray(e)?baseMatchesProperty(e[0],e[1]):baseMatches(e):property(e)}function baseForOwn(e,n){return e&&baseFor(e,n,keys)}function createBaseEach(o,i){return function(e,n){if(null==e)return e;if(!isArrayLike(e))return o(e,n);for(var t=e.length,r=i?t:-1,a=Object(e);(i?r--:++r<t)&&!1!==n(a[r],r,a););return e}}var baseEach=createBaseEach(baseForOwn);const baseEach$1=baseEach;var now=function(){return root.Date.now()};const now$1=now;var objectProto$1=Object.prototype,hasOwnProperty$1=objectProto$1.hasOwnProperty,defaults=baseRest(function(e,n){e=Object(e);var t=-1,r=n.length,a=2<r?n[2]:void 0;for(a&&isIterateeCall(n[0],n[1],a)&&(r=1);++t<r;)for(var o=n[t],i=keysIn(o),s=-1,u=i.length;++s<u;){var c=i[s],d=e[c];(void 0===d||eq(d,objectProto$1[c])&&!hasOwnProperty$1.call(e,c))&&(e[c]=o[c])}return e});const defaults$1=defaults;function arrayIncludesWith(e,n,t){for(var r=-1,a=null==e?0:e.length;++r<a;)if(t(n,e[r]))return!0;return!1}function last(e){var n=null==e?0:e.length;return n?e[n-1]:void 0}function castFunction(e){return"function"==typeof e?e:identity}function forEach(e,n){return(isArray(e)?arrayEach:baseEach$1)(e,castFunction(n))}function baseFilter(e,r){var a=[];return baseEach$1(e,function(e,n,t){r(e,n,t)&&a.push(e)}),a}function filter(e,n){return(isArray(e)?arrayFilter:baseFilter)(e,baseIteratee(n))}function createFind(o){return function(e,n,t){var r,a=Object(e),n=(isArrayLike(e)||(r=baseIteratee(n),e=keys(e),n=function(e){return r(a[e],e,a)}),o(e,n,t));return-1<n?a[r?e[n]:n]:void 0}}var nativeMax$1=Math.max;function findIndex(e,n,t){var r=null==e?0:e.length;if(!r)return-1;t=null==t?0:toInteger(t);return t<0&&(t=nativeMax$1(r+t,0)),baseFindIndex(e,baseIteratee(n),t)}var find=createFind(findIndex);const find$1=find;function baseMap(e,r){var a=-1,o=isArrayLike(e)?Array(e.length):[];return baseEach$1(e,function(e,n,t){o[++a]=r(e,n,t)}),o}function map(e,n){return(isArray(e)?arrayMap:baseMap)(e,baseIteratee(n))}function forIn(e,n){return null==e?e:baseFor(e,castFunction(n),keysIn)}function forOwn(e,n){return e&&baseForOwn(e,castFunction(n))}function baseGt(e,n){return n<e}var objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty;function baseHas(e,n){return null!=e&&hasOwnProperty.call(e,n)}function has(e,n){return null!=e&&hasPath(e,n,baseHas)}function baseValues(n,e){return arrayMap(e,function(e){return n[e]})}function values(e){return null==e?[]:baseValues(e,keys(e))}function isUndefined(e){return void 0===e}function baseLt(e,n){return e<n}function mapValues(e,r){var a={};return r=baseIteratee(r),baseForOwn(e,function(e,n,t){baseAssignValue(a,n,r(e,n,t))}),a}function baseExtremum(e,n,t){for(var r=-1,a=e.length;++r<a;){var o,i,s=e[r],u=n(s);null!=u&&(void 0===o?u==u&&!isSymbol(u):t(u,o))&&(o=u,i=s)}return i}function max(e){return e&&e.length?baseExtremum(e,identity,baseGt):void 0}function min(e){return e&&e.length?baseExtremum(e,identity,baseLt):void 0}function minBy(e,n){return e&&e.length?baseExtremum(e,baseIteratee(n),baseLt):void 0}function baseSet(e,n,t,r){if(!isObject(e))return e;for(var a=-1,o=(n=castPath(n,e)).length,i=o-1,s=e;null!=s&&++a<o;){var u,c=toKey(n[a]),d=t;if("__proto__"===c||"constructor"===c||"prototype"===c)return e;a!=i&&(u=s[c],void 0===(d=r?r(u,c,s):void 0)&&(d=isObject(u)?u:isIndex(n[a+1])?[]:{})),assignValue(s,c,d),s=s[c]}return e}function basePickBy(e,n,t){for(var r=-1,a=n.length,o={};++r<a;){var i=n[r],s=baseGet(e,i);t(s,i)&&baseSet(o,castPath(i,e),s)}return o}function baseSortBy(e,n){var t=e.length;for(e.sort(n);t--;)e[t]=e[t].value;return e}function compareAscending(e,n){if(e!==n){var t=void 0!==e,r=null===e,a=e==e,o=isSymbol(e),i=void 0!==n,s=null===n,u=n==n,c=isSymbol(n);if(!s&&!c&&!o&&n<e||o&&i&&u&&!s&&!c||r&&i&&u||!t&&u||!a)return 1;if(!r&&!o&&!c&&e<n||c&&t&&a&&!r&&!o||s&&t&&a||!i&&a||!u)return-1}return 0}function compareMultiple(e,n,t){for(var r=-1,a=e.criteria,o=n.criteria,i=a.length,s=t.length;++r<i;){var u=compareAscending(a[r],o[r]);if(u)return s<=r?u:u*("desc"==t[r]?-1:1)}return e.index-n.index}function baseOrderBy(e,r,t){r=r.length?arrayMap(r,function(n){return isArray(n)?function(e){return baseGet(e,1===n.length?n[0]:n)}:n}):[identity];var a=-1;return r=arrayMap(r,baseUnary(baseIteratee)),baseSortBy(baseMap(e,function(n,e,t){return{criteria:arrayMap(r,function(e){return e(n)}),index:++a,value:n}}),function(e,n){return compareMultiple(e,n,t)})}function basePick(t,e){return basePickBy(t,e,function(e,n){return hasIn(t,n)})}var pick=flatRest(function(e,n){return null==e?{}:basePick(e,n)});const pick$1=pick;var nativeCeil=Math.ceil,nativeMax=Math.max;function baseRange(e,n,t,r){for(var a=-1,o=nativeMax(nativeCeil((n-e)/(t||1)),0),i=Array(o);o--;)i[r?o:++a]=e,e+=t;return i}function createRange(r){return function(e,n,t){return t&&"number"!=typeof t&&isIterateeCall(e,n,t)&&(n=t=void 0),e=toFinite(e),void 0===n?(n=e,e=0):n=toFinite(n),baseRange(e,n,t=void 0===t?e<n?1:-1:toFinite(t),r)}}var range=createRange();const range$1=range;function baseReduce(e,r,a,o,n){return n(e,function(e,n,t){a=o?(o=!1,e):r(a,e,n,t)}),a}function reduce(e,n,t){var r=isArray(e)?arrayReduce:baseReduce,a=arguments.length<3;return r(e,baseIteratee(n),t,a,baseEach$1)}var sortBy=baseRest(function(e,n){if(null==e)return[];var t=n.length;return 1<t&&isIterateeCall(e,n[0],n[1])?n=[]:2<t&&isIterateeCall(n[0],n[1],n[2])&&(n=[n[0]]),baseOrderBy(e,baseFlatten(n,1),[])});const sortBy$1=sortBy;var INFINITY=1/0,createSet=Set&&1/setToArray(new Set([,-0]))[1]==INFINITY?function(e){return new Set(e)}:noop;const createSet$1=createSet;var LARGE_ARRAY_SIZE=200;function baseUniq(e,n,t){var r=-1,a=arrayIncludes,o=e.length,i=!0,s=[],u=s;if(t)i=!1,a=arrayIncludesWith;else if(LARGE_ARRAY_SIZE<=o){var c=n?null:createSet$1(e);if(c)return setToArray(c);i=!1,a=cacheHas,u=new SetCache}else u=n?[]:s;e:for(;++r<o;){var d=e[r],f=n?n(d):d,d=t||0!==d?d:0;if(i&&f==f){for(var l=u.length;l--;)if(u[l]===f)continue e;n&&u.push(f),s.push(d)}else a(u,f,t)||(u!==s&&u.push(f),s.push(d))}return s}var union=baseRest(function(e){return baseUniq(baseFlatten(e,1,isArrayLikeObject,!0))});const union$1=union;var idCounter=0;function uniqueId(e){var n=++idCounter;return toString(e)+n}function baseZipObject(e,n,t){for(var r=-1,a=e.length,o=n.length,i={};++r<a;){var s=r<o?n[r]:void 0;t(i,e[r],s)}return i}function zipObject(e,n){return baseZipObject(e||[],n||[],assignValue)}var DEFAULT_EDGE_NAME="\0",GRAPH_NODE="\0",EDGE_KEY_DELIM="";class Graph{constructor(e={}){this._isDirected=!has(e,"directed")||e.directed,this._isMultigraph=!!has(e,"multigraph")&&e.multigraph,this._isCompound=!!has(e,"compound")&&e.compound,this._label=void 0,this._defaultNodeLabelFn=constant(void 0),this._defaultEdgeLabelFn=constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[GRAPH_NODE]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}isDirected(){return this._isDirected}isMultigraph(){return this._isMultigraph}isCompound(){return this._isCompound}setGraph(e){return this._label=e,this}graph(){return this._label}setDefaultNodeLabel(e){return isFunction(e)||(e=constant(e)),this._defaultNodeLabelFn=e,this}nodeCount(){return this._nodeCount}nodes(){return keys(this._nodes)}sources(){var n=this;return filter(this.nodes(),function(e){return isEmpty(n._in[e])})}sinks(){var n=this;return filter(this.nodes(),function(e){return isEmpty(n._out[e])})}setNodes(e,n){var t=arguments,r=this;return forEach(e,function(e){1<t.length?r.setNode(e,n):r.setNode(e)}),this}setNode(e,n){return has(this._nodes,e)?1<arguments.length&&(this._nodes[e]=n):(this._nodes[e]=1<arguments.length?n:this._defaultNodeLabelFn(e),this._isCompound&&(this._parent[e]=GRAPH_NODE,this._children[e]={},this._children[GRAPH_NODE][e]=!0),this._in[e]={},this._preds[e]={},this._out[e]={},this._sucs[e]={},++this._nodeCount),this}node(e){return this._nodes[e]}hasNode(e){return has(this._nodes,e)}removeNode(e){var n,t=this;return has(this._nodes,e)&&(n=function(e){t.removeEdge(t._edgeObjs[e])},delete this._nodes[e],this._isCompound&&(this._removeFromParentsChildList(e),delete this._parent[e],forEach(this.children(e),function(e){t.setParent(e)}),delete this._children[e]),forEach(keys(this._in[e]),n),delete this._in[e],delete this._preds[e],forEach(keys(this._out[e]),n),delete this._out[e],delete this._sucs[e],--this._nodeCount),this}setParent(e,n){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(isUndefined(n))n=GRAPH_NODE;else{for(var t=n+="";!isUndefined(t);t=this.parent(t))if(t===e)throw new Error("Setting "+n+" as parent of "+e+" would create a cycle");this.setNode(n)}return this.setNode(e),this._removeFromParentsChildList(e),this._parent[e]=n,this._children[n][e]=!0,this}_removeFromParentsChildList(e){delete this._children[this._parent[e]][e]}parent(e){if(this._isCompound){e=this._parent[e];if(e!==GRAPH_NODE)return e}}children(e){if(isUndefined(e)&&(e=GRAPH_NODE),!this._isCompound)return e===GRAPH_NODE?this.nodes():this.hasNode(e)?[]:void 0;e=this._children[e];return e?keys(e):void 0}predecessors(e){e=this._preds[e];if(e)return keys(e)}successors(e){e=this._sucs[e];if(e)return keys(e)}neighbors(e){var n=this.predecessors(e);if(n)return union$1(n,this.successors(e))}isLeaf(e){e=this.isDirected()?this.successors(e):this.neighbors(e);return 0===e.length}filterNodes(t){var r=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound}),a=(r.setGraph(this.graph()),this),o=(forEach(this._nodes,function(e,n){t(n)&&r.setNode(n,e)}),forEach(this._edgeObjs,function(e){r.hasNode(e.v)&&r.hasNode(e.w)&&r.setEdge(e,a.edge(e))}),{});return this._isCompound&&forEach(r.nodes(),function(e){r.setParent(e,function e(n){var t=a.parent(n);return void 0===t||r.hasNode(t)?o[n]=t:t in o?o[t]:e(t)}(e))}),r}setDefaultEdgeLabel(e){return isFunction(e)||(e=constant(e)),this._defaultEdgeLabelFn=e,this}edgeCount(){return this._edgeCount}edges(){return values(this._edgeObjs)}setPath(e,t){var r=this,a=arguments;return reduce(e,function(e,n){return 1<a.length?r.setEdge(e,n,t):r.setEdge(e,n),n}),this}setEdge(){var e,n,t=!1,r=arguments[0],r=("object"==typeof r&&null!==r&&"v"in r?(a=r.v,o=r.w,e=r.name,2===arguments.length&&(n=arguments[1],t=!0)):(a=r,o=arguments[1],e=arguments[3],2<arguments.length&&(n=arguments[2],t=!0)),a=""+a,o=""+o,isUndefined(e)||(e=""+e),edgeArgsToId(this._isDirected,a,o,e));if(has(this._edgeLabels,r))return t&&(this._edgeLabels[r]=n),this;if(!isUndefined(e)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(a),this.setNode(o),this._edgeLabels[r]=t?n:this._defaultEdgeLabelFn(a,o,e);var t=edgeArgsToObj(this._isDirected,a,o,e),a=t.v,o=t.w;return Object.freeze(t),this._edgeObjs[r]=t,incrementOrInitEntry(this._preds[o],a),incrementOrInitEntry(this._sucs[a],o),this._in[o][r]=t,this._out[a][r]=t,this._edgeCount++,this}edge(e,n,t){var r=1===arguments.length?edgeObjToId(this._isDirected,e):edgeArgsToId(this._isDirected,e,n,t);return this._edgeLabels[r]}hasEdge(e,n,t){var r=1===arguments.length?edgeObjToId(this._isDirected,e):edgeArgsToId(this._isDirected,e,n,t);return has(this._edgeLabels,r)}removeEdge(e,n,t){var r=1===arguments.length?edgeObjToId(this._isDirected,arguments[0]):edgeArgsToId(this._isDirected,e,n,t),a=this._edgeObjs[r];return a&&(e=a.v,n=a.w,delete this._edgeLabels[r],delete this._edgeObjs[r],decrementOrRemoveEntry(this._preds[n],e),decrementOrRemoveEntry(this._sucs[e],n),delete this._in[n][r],delete this._out[e][r],this._edgeCount--),this}inEdges(e,n){var e=this._in[e];if(e)return e=values(e),n?filter(e,function(e){return e.v===n}):e}outEdges(e,n){var e=this._out[e];if(e)return e=values(e),n?filter(e,function(e){return e.w===n}):e}nodeEdges(e,n){var t=this.inEdges(e,n);if(t)return t.concat(this.outEdges(e,n))}}function incrementOrInitEntry(e,n){e[n]?e[n]++:e[n]=1}function decrementOrRemoveEntry(e,n){--e[n]||delete e[n]}function edgeArgsToId(e,n,t,r){n=""+n,t=""+t;return!e&&t<n&&(e=n,n=t,t=e),n+EDGE_KEY_DELIM+t+EDGE_KEY_DELIM+(isUndefined(r)?DEFAULT_EDGE_NAME:r)}function edgeArgsToObj(e,n,t,r){n=""+n,t=""+t,!e&&t<n&&(e=n,n=t,t=e),e={v:n,w:t};return r&&(e.name=r),e}function edgeObjToId(e,n){return edgeArgsToId(e,n.v,n.w,n.name)}Graph.prototype._nodeCount=0,Graph.prototype._edgeCount=0;class List{constructor(){var e={};e._next=e._prev=e,this._sentinel=e}dequeue(){var e=this._sentinel,n=e._prev;if(n!==e)return unlink(n),n}enqueue(e){var n=this._sentinel;e._prev&&e._next&&unlink(e),e._next=n._next,n._next._prev=e,(n._next=e)._prev=n}toString(){for(var e=[],n=this._sentinel,t=n._prev;t!==n;)e.push(JSON.stringify(t,filterOutLinks)),t=t._prev;return"["+e.join(", ")+"]"}}function unlink(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function filterOutLinks(e,n){if("_next"!==e&&"_prev"!==e)return n}var DEFAULT_WEIGHT_FN=constant(1);function greedyFAS(n,e){if(n.nodeCount()<=1)return[];e=buildState(n,e||DEFAULT_WEIGHT_FN);return flatten(map(doGreedyFAS(e.graph,e.buckets,e.zeroIdx),function(e){return n.outEdges(e.v,e.w)}))}function doGreedyFAS(e,n,t){for(var r,a=[],o=n[n.length-1],i=n[0];e.nodeCount();){for(;r=i.dequeue();)removeNode(e,n,t,r);for(;r=o.dequeue();)removeNode(e,n,t,r);if(e.nodeCount())for(var s=n.length-2;0<s;--s)if(r=n[s].dequeue()){a=a.concat(removeNode(e,n,t,r,!0));break}}return a}function removeNode(r,a,o,e,i){var s=i?[]:void 0;return forEach(r.inEdges(e.v),function(e){var n=r.edge(e),t=r.node(e.v);i&&s.push({v:e.v,w:e.w}),t.out-=n,assignBucket(a,o,t)}),forEach(r.outEdges(e.v),function(e){var n=r.edge(e),e=e.w,e=r.node(e);e.in-=n,assignBucket(a,o,e)}),r.removeNode(e.v),s}function buildState(e,r){var a=new Graph,o=0,i=0,n=(forEach(e.nodes(),function(e){a.setNode(e,{v:e,in:0,out:0})}),forEach(e.edges(),function(e){var n=a.edge(e.v,e.w)||0,t=r(e);a.setEdge(e.v,e.w,n+t),i=Math.max(i,a.node(e.v).out+=t),o=Math.max(o,a.node(e.w).in+=t)}),range$1(i+o+3).map(function(){return new List})),t=o+1;return forEach(a.nodes(),function(e){assignBucket(n,t,a.node(e))}),{graph:a,buckets:n,zeroIdx:t}}function assignBucket(e,n,t){(t.out?t.in?e[t.out-t.in+n]:e[e.length-1]:e[0]).enqueue(t)}function run$2(t){var n;forEach("greedy"===t.graph().acyclicer?greedyFAS(t,(n=t,function(e){return n.edge(e).weight})):dfsFAS(t),function(e){var n=t.edge(e);t.removeEdge(e),n.forwardName=e.name,n.reversed=!0,t.setEdge(e.w,e.v,n,uniqueId("rev"))})}function dfsFAS(t){var r=[],a={},o={};return forEach(t.nodes(),function n(e){has(o,e)||(o[e]=!0,a[e]=!0,forEach(t.outEdges(e),function(e){has(a,e.w)?r.push(e):n(e.w)}),delete a[e])}),r}function undo$2(r){forEach(r.edges(),function(e){var n,t=r.edge(e);t.reversed&&(r.removeEdge(e),n=t.forwardName,delete t.reversed,delete t.forwardName,r.setEdge(e.w,e.v,t,n))})}function addDummyNode(e,n,t,r){for(var a;a=uniqueId(r),e.hasNode(a););return t.dummy=n,e.setNode(a,t),a}function simplify(r){var a=(new Graph).setGraph(r.graph());return forEach(r.nodes(),function(e){a.setNode(e,r.node(e))}),forEach(r.edges(),function(e){var n=a.edge(e.v,e.w)||{weight:0,minlen:1},t=r.edge(e);a.setEdge(e.v,e.w,{weight:n.weight+t.weight,minlen:Math.max(n.minlen,t.minlen)})}),a}function asNonCompoundGraph(n){var t=new Graph({multigraph:n.isMultigraph()}).setGraph(n.graph());return forEach(n.nodes(),function(e){n.children(e).length||t.setNode(e,n.node(e))}),forEach(n.edges(),function(e){t.setEdge(e,n.edge(e))}),t}function intersectRect(e,n){var t,r=e.x,a=e.y,o=n.x-r,n=n.y-a,i=e.width/2,e=e.height/2;if(o||n)return e=Math.abs(n)*i>Math.abs(o)*e?(t=(e=n<0?-e:e)*o/n,e):(t=i=o<0?-i:i)*n/o,{x:r+t,y:a+e};throw new Error("Not possible to find intersection inside of the rectangle")}function buildLayerMatrix(r){var a=map(range$1(maxRank(r)+1),function(){return[]});return forEach(r.nodes(),function(e){var n=r.node(e),t=n.rank;isUndefined(t)||(a[t][n.order]=e)}),a}function normalizeRanks(n){var t=min(map(n.nodes(),function(e){return n.node(e).rank}));forEach(n.nodes(),function(e){e=n.node(e);has(e,"rank")&&(e.rank-=t)})}function removeEmptyRanks(t){var r=min(map(t.nodes(),function(e){return t.node(e).rank})),a=[],o=(forEach(t.nodes(),function(e){var n=t.node(e).rank-r;a[n]||(a[n]=[]),a[n].push(e)}),0),i=t.graph().nodeRankFactor;forEach(a,function(e,n){isUndefined(e)&&n%i!=0?--o:o&&forEach(e,function(e){t.node(e).rank+=o})})}function addBorderNode$1(e,n,t,r){var a={width:0,height:0};return 4<=arguments.length&&(a.rank=t,a.order=r),addDummyNode(e,"border",a,n)}function maxRank(n){return max(map(n.nodes(),function(e){e=n.node(e).rank;if(!isUndefined(e))return e}))}function partition(e,n){var t={lhs:[],rhs:[]};return forEach(e,function(e){(n(e)?t.lhs:t.rhs).push(e)}),t}function time(e,n){var t=now$1();try{return n()}finally{console.log(e+" time: "+(now$1()-t)+"ms")}}function notime(e,n){return n()}function addBorderSegments(i){forEach(i.children(),function e(n){var t=i.children(n),r=i.node(n);if(t.length&&forEach(t,e),has(r,"minRank")){r.borderLeft=[],r.borderRight=[];for(var a=r.minRank,o=r.maxRank+1;a<o;++a)addBorderNode(i,"borderLeft","_bl",n,r,a),addBorderNode(i,"borderRight","_br",n,r,a)}})}function addBorderNode(e,n,t,r,a,o){var i=a[n][o-1],t=addDummyNode(e,"border",{width:0,height:0,rank:o,borderType:n},t);a[n][o]=t,e.setParent(t,r),i&&e.setEdge(i,t,{weight:1})}function adjust(e){var n=e.graph().rankdir.toLowerCase();"lr"!==n&&"rl"!==n||swapWidthHeight(e)}function undo$1(e){var n=e.graph().rankdir.toLowerCase();"bt"!==n&&"rl"!==n||reverseY(e),"lr"!==n&&"rl"!==n||(swapXY(e),swapWidthHeight(e))}function swapWidthHeight(n){forEach(n.nodes(),function(e){swapWidthHeightOne(n.node(e))}),forEach(n.edges(),function(e){swapWidthHeightOne(n.edge(e))})}function swapWidthHeightOne(e){var n=e.width;e.width=e.height,e.height=n}function reverseY(n){forEach(n.nodes(),function(e){reverseYOne(n.node(e))}),forEach(n.edges(),function(e){e=n.edge(e);forEach(e.points,reverseYOne),has(e,"y")&&reverseYOne(e)})}function reverseYOne(e){e.y=-e.y}function swapXY(n){forEach(n.nodes(),function(e){swapXYOne(n.node(e))}),forEach(n.edges(),function(e){e=n.edge(e);forEach(e.points,swapXYOne),has(e,"x")&&swapXYOne(e)})}function swapXYOne(e){var n=e.x;e.x=e.y,e.y=n}function run$1(n){n.graph().dummyChains=[],forEach(n.edges(),function(e){normalizeEdge(n,e)})}function normalizeEdge(e,n){var t,r,a,o=n.v,i=e.node(o).rank,s=n.w,u=e.node(s).rank,c=n.name,d=e.edge(n),f=d.labelRank;if(u!==i+1){for(e.removeEdge(n),a=0,++i;i<u;++a,++i)d.points=[],t=addDummyNode(e,"edge",r={width:0,height:0,edgeLabel:d,edgeObj:n,rank:i},"_d"),i===f&&(r.width=d.width,r.height=d.height,r.dummy="edge-label",r.labelpos=d.labelpos),e.setEdge(o,t,{weight:d.weight},c),0===a&&e.graph().dummyChains.push(t),o=t;e.setEdge(o,s,{weight:d.weight},c)}}function undo(a){forEach(a.graph().dummyChains,function(e){var n,t=a.node(e),r=t.edgeLabel;for(a.setEdge(t.edgeObj,r);t.dummy;)n=a.successors(e)[0],a.removeNode(e),r.points.push({x:t.x,y:t.y}),"edge-label"===t.dummy&&(r.x=t.x,r.y=t.y,r.width=t.width,r.height=t.height),t=a.node(e=n)})}function longestPath(r){var a={};forEach(r.sources(),function n(e){var t=r.node(e);if(has(a,e))return t.rank;a[e]=!0;e=min(map(r.outEdges(e),function(e){return n(e.w)-r.edge(e).minlen}));return e!==Number.POSITIVE_INFINITY&&null!=e||(e=0),t.rank=e})}function slack(e,n){return e.node(n.w).rank-e.node(n.v).rank-e.edge(n).minlen}function feasibleTree(e){var n,t=new Graph({directed:!1}),r=e.nodes()[0],a=e.nodeCount();for(t.setNode(r,{});tightTree(t,e)<a;)n=findMinSlackEdge(t,e),n=t.hasNode(n.v)?slack(e,n):-slack(e,n),shiftRanks(t,e,n);return t}function tightTree(a,o){return forEach(a.nodes(),function t(r){forEach(o.nodeEdges(r),function(e){var n=e.v,n=r===n?e.w:n;a.hasNode(n)||slack(o,e)||(a.setNode(n,{}),a.setEdge(r,n,{}),t(n))})}),a.nodeCount()}function findMinSlackEdge(n,t){return minBy(t.edges(),function(e){if(n.hasNode(e.v)!==n.hasNode(e.w))return slack(t,e)})}function shiftRanks(e,n,t){forEach(e.nodes(),function(e){n.node(e).rank+=t})}function CycleException(){}function dfs$1(n,e,t){isArray(e)||(e=[e]);var r=(n.isDirected()?n.successors:n.neighbors).bind(n),a=[],o={};return forEach(e,function(e){if(!n.hasNode(e))throw new Error("Graph does not have node: "+e);doDfs(n,e,"post"===t,o,r,a)}),a}function doDfs(n,e,t,r,a,o){has(r,e)||(r[e]=!0,t||o.push(e),forEach(a(e),function(e){doDfs(n,e,t,r,a,o)}),t&&o.push(e))}function postorder$1(e,n){return dfs$1(e,n,"post")}function preorder(e,n){return dfs$1(e,n,"pre")}function networkSimplex(e){longestPath(e=simplify(e));var n,t=feasibleTree(e);for(initLowLimValues(t),initCutValues(t,e);n=leaveEdge(t);)exchangeEdges(t,e,n,enterEdge(t,e,n))}function initCutValues(n,t){var e=postorder$1(n,n.nodes());forEach(e=e.slice(0,e.length-1),function(e){assignCutValue(n,t,e)})}function assignCutValue(e,n,t){var r=e.node(t).parent;e.edge(t,r).cutvalue=calcCutValue(e,n,t)}function calcCutValue(r,a,o){var i=r.node(o).parent,s=!0,e=a.edge(o,i),u=0;return e||(s=!1,e=a.edge(i,o)),u=e.weight,forEach(a.nodeEdges(o),function(e){var n=e.v===o,t=n?e.w:e.v;t!==i&&(n=n===s,e=a.edge(e).weight,u+=n?e:-e,isTreeEdge(r,o,t)&&(e=r.edge(o,t).cutvalue,u+=n?-e:e))}),u}function initLowLimValues(e,n){arguments.length<2&&(n=e.nodes()[0]),dfsAssignLowLim(e,{},1,n)}function dfsAssignLowLim(n,t,r,a,e){var o=r,i=n.node(a);return t[a]=!0,forEach(n.neighbors(a),function(e){has(t,e)||(r=dfsAssignLowLim(n,t,r,e,a))}),i.low=o,i.lim=r++,e?i.parent=e:delete i.parent,r}function leaveEdge(n){return find$1(n.edges(),function(e){return n.edge(e).cutvalue<0})}function enterEdge(n,t,e){var r=e.v,a=e.w,e=(t.hasEdge(r,a)||(r=e.w,a=e.v),n.node(r)),r=n.node(a),o=e,i=!1;return e.lim>r.lim&&(o=r,i=!0),minBy(filter(t.edges(),function(e){return i===isDescendant(n,n.node(e.v),o)&&i!==isDescendant(n,n.node(e.w),o)}),function(e){return slack(t,e)})}function exchangeEdges(e,n,t,r){var a=t.v,t=t.w;e.removeEdge(a,t),e.setEdge(r.v,r.w,{}),initLowLimValues(e),initCutValues(e,n),updateRanks(e,n)}function updateRanks(a,o){var e=find$1(a.nodes(),function(e){return!o.node(e).parent});forEach(preorder(a,e).slice(1),function(e){var n=a.node(e).parent,t=o.edge(e,n),r=!1;t||(t=o.edge(n,e),r=!0),o.node(e).rank=o.node(n).rank+(r?t.minlen:-t.minlen)})}function isTreeEdge(e,n,t){return e.hasEdge(n,t)}function isDescendant(e,n,t){return t.low<=n.lim&&n.lim<=t.lim}function rank(e){switch(e.graph().ranker){case"network-simplex":networkSimplexRanker(e);break;case"tight-tree":tightTreeRanker(e);break;case"longest-path":longestPathRanker(e);break;default:networkSimplexRanker(e)}}CycleException.prototype=new Error,networkSimplex.initLowLimValues=initLowLimValues,networkSimplex.initCutValues=initCutValues,networkSimplex.calcCutValue=calcCutValue,networkSimplex.leaveEdge=leaveEdge,networkSimplex.enterEdge=enterEdge,networkSimplex.exchangeEdges=exchangeEdges;var longestPathRanker=longestPath;function tightTreeRanker(e){longestPath(e),feasibleTree(e)}function networkSimplexRanker(e){networkSimplex(e)}function run(n){var t=addDummyNode(n,"root",{},"_root"),r=treeDepths(n),a=max(values(r))-1,o=2*a+1,i=(n.graph().nestingRoot=t,forEach(n.edges(),function(e){n.edge(e).minlen*=o}),sumWeights(n)+1);forEach(n.children(),function(e){dfs(n,t,o,i,a,r,e)}),n.graph().nodeRankFactor=o}function dfs(a,o,i,s,u,c,d){var f,l,e,n=a.children(d);n.length?(f=addBorderNode$1(a,"_bt"),l=addBorderNode$1(a,"_bb"),e=a.node(d),a.setParent(f,d),e.borderTop=f,a.setParent(l,d),e.borderBottom=l,forEach(n,function(e){dfs(a,o,i,s,u,c,e);var n=a.node(e),t=n.borderTop||e,e=n.borderBottom||e,n=n.borderTop?s:2*s,r=t!==e?1:u-c[d]+1;a.setEdge(f,t,{weight:n,minlen:r,nestingEdge:!0}),a.setEdge(e,l,{weight:n,minlen:r,nestingEdge:!0})}),a.parent(d)||a.setEdge(o,f,{weight:0,minlen:u+c[d]})):d!==o&&a.setEdge(o,d,{weight:0,minlen:i})}function treeDepths(a){var o={};return forEach(a.children(),function(e){!function n(e,t){var r=a.children(e);r&&r.length&&forEach(r,function(e){n(e,t+1)}),o[e]=t}(e,1)}),o}function sumWeights(t){return reduce(t.edges(),function(e,n){return e+t.edge(n).weight},0)}function cleanup(n){var e=n.graph();n.removeNode(e.nestingRoot),delete e.nestingRoot,forEach(n.edges(),function(e){n.edge(e).nestingEdge&&n.removeEdge(e)})}function addSubgraphConstraints(a,o,e){var i,s={};forEach(e,function(e){for(var n,t,r=a.parent(e);r;){if((n=a.parent(r))?(t=s[n],s[n]=r):(t=i,i=r),t&&t!==r)return void o.setEdge(t,r);r=n}})}function buildLayerGraph(a,t,o){var i=createRootNode(a),s=new Graph({compound:!0}).setGraph({root:i}).setDefaultNodeLabel(function(e){return a.node(e)});return forEach(a.nodes(),function(r){var e=a.node(r),n=a.parent(r);(e.rank===t||e.minRank<=t&&t<=e.maxRank)&&(s.setNode(r),s.setParent(r,n||i),forEach(a[o](r),function(e){var n=e.v===r?e.w:e.v,t=s.edge(n,r),t=isUndefined(t)?0:t.weight;s.setEdge(n,r,{weight:a.edge(e).weight+t})}),has(e,"minRank")&&s.setNode(r,{borderLeft:e.borderLeft[t],borderRight:e.borderRight[t]}))}),s}function createRootNode(e){for(var n;e.hasNode(n=uniqueId("_root")););return n}function crossCount(e,n){for(var t=0,r=1;r<n.length;++r)t+=twoLayerCrossCount(e,n[r-1],n[r]);return t}function twoLayerCrossCount(n,e,t){for(var r=zipObject(t,map(t,function(e,n){return n})),e=flatten(map(e,function(e){return sortBy$1(map(n.outEdges(e),function(e){return{pos:r[e.w],weight:n.edge(e).weight}}),"pos")})),a=1;a<t.length;)a<<=1;var o=2*a-1,i=(--a,map(new Array(o),function(){return 0})),s=0;return forEach(e.forEach(function(e){for(var n=e.pos+a,t=(i[n]+=e.weight,0);0<n;)n%2&&(t+=i[n+1]),i[n=n-1>>1]+=e.weight;s+=e.weight*t})),s}function initOrder(r){var a={},e=filter(r.nodes(),function(e){return!r.children(e).length}),n=max(map(e,function(e){return r.node(e).rank})),o=map(range$1(n+1),function(){return[]});return forEach(sortBy$1(e,function(e){return r.node(e).rank}),function e(n){var t;has(a,n)||(a[n]=!0,t=r.node(n),o[t.rank].push(n),forEach(r.successors(n),e))}),o}function barycenter(r,e){return map(e,function(e){var n=r.inEdges(e);return n.length?{v:e,barycenter:(n=reduce(n,function(e,n){var t=r.edge(n),n=r.node(n.v);return{sum:e.sum+t.weight*n.order,weight:e.weight+t.weight}},{sum:0,weight:0})).sum/n.weight,weight:n.weight}:{v:e}})}function resolveConflicts(e,n){var r={};return forEach(e,function(e,n){n=r[e.v]={indegree:0,in:[],out:[],vs:[e.v],i:n};isUndefined(e.barycenter)||(n.barycenter=e.barycenter,n.weight=e.weight)}),forEach(n.edges(),function(e){var n=r[e.v],t=r[e.w];isUndefined(n)||isUndefined(t)||(t.indegree++,n.out.push(r[e.w]))}),doResolveConflicts(filter(r,function(e){return!e.indegree}))}function doResolveConflicts(t){var e=[];for(;t.length;){var n=t.pop();e.push(n),forEach(n.in.reverse(),function(n){return function(e){e.merged||(isUndefined(e.barycenter)||isUndefined(n.barycenter)||e.barycenter>=n.barycenter)&&mergeEntries(n,e)}}(n)),forEach(n.out,function(n){return function(e){e.in.push(n),0==--e.indegree&&t.push(e)}}(n))}return map(filter(e,function(e){return!e.merged}),function(e){return pick$1(e,["vs","i","barycenter","weight"])})}function mergeEntries(e,n){var t=0,r=0;e.weight&&(t+=e.barycenter*e.weight,r+=e.weight),n.weight&&(t+=n.barycenter*n.weight,r+=n.weight),e.vs=n.vs.concat(e.vs),e.barycenter=t/r,e.weight=r,e.i=Math.min(n.i,e.i),n.merged=!0}function sort(e,n){var e=partition(e,function(e){return has(e,"barycenter")}),t=e.lhs,r=sortBy$1(e.rhs,function(e){return-e.i}),a=[],o=0,i=0,s=0,e=(t.sort(compareWithBias(!!n)),s=consumeUnsortable(a,r,s),forEach(t,function(e){s+=e.vs.length,a.push(e.vs),o+=e.barycenter*e.weight,i+=e.weight,s=consumeUnsortable(a,r,s)}),{vs:flatten(a)});return i&&(e.barycenter=o/i,e.weight=i),e}function consumeUnsortable(e,n,t){for(var r;n.length&&(r=last(n)).i<=t;)n.pop(),e.push(r.vs),t++;return t}function compareWithBias(t){return function(e,n){return e.barycenter<n.barycenter?-1:e.barycenter>n.barycenter?1:t?n.i-e.i:e.i-n.i}}function sortSubgraph(t,e,r,a){var n,o=t.children(e),e=t.node(e),i=e?e.borderLeft:void 0,s=e?e.borderRight:void 0,u={},e=(i&&(o=filter(o,function(e){return e!==i&&e!==s})),barycenter(t,o)),o=(forEach(e,function(e){var n;t.children(e.v).length&&(n=sortSubgraph(t,e.v,r,a),has(u[e.v]=n,"barycenter")&&mergeBarycenters(e,n))}),resolveConflicts(e,r)),e=(expandSubgraphs(o,u),sort(o,a));return i&&(e.vs=flatten([i,e.vs,s]),t.predecessors(i).length&&(o=t.node(t.predecessors(i)[0]),n=t.node(t.predecessors(s)[0]),has(e,"barycenter")||(e.barycenter=0,e.weight=0),e.barycenter=(e.barycenter*e.weight+o.order+n.order)/(e.weight+2),e.weight+=2)),e}function expandSubgraphs(e,n){forEach(e,function(e){e.vs=flatten(e.vs.map(function(e){return n[e]?n[e].vs:e}))})}function mergeBarycenters(e,n){isUndefined(e.barycenter)?(e.barycenter=n.barycenter,e.weight=n.weight):(e.barycenter=(e.barycenter*e.weight+n.barycenter*n.weight)/(e.weight+n.weight),e.weight+=n.weight)}function order(e){for(var n,t=maxRank(e),r=buildLayerGraphs(e,range$1(1,t+1),"inEdges"),a=buildLayerGraphs(e,range$1(t-1,-1,-1),"outEdges"),o=(assignOrder(e,initOrder(e)),Number.POSITIVE_INFINITY),i=0,s=0;s<4;++i,++s){sweepLayerGraphs(i%2?r:a,2<=i%4);var u,c=crossCount(e,u=buildLayerMatrix(e));c<o&&(s=0,n=cloneDeep(u),o=c)}assignOrder(e,n)}function buildLayerGraphs(n,e,t){return map(e,function(e){return buildLayerGraph(n,e,t)})}function sweepLayerGraphs(e,n){var r=new Graph;forEach(e,function(t){var e=t.graph().root,e=sortSubgraph(t,e,r,n);forEach(e.vs,function(e,n){t.node(e).order=n}),addSubgraphConstraints(t,r,e.vs)})}function assignOrder(t,e){forEach(e,function(e){forEach(e,function(e,n){t.node(e).order=n})})}function parentDummyChains(c){var d=postorder(c);forEach(c.graph().dummyChains,function(e){for(var n,t=c.node(e).edgeObj,r=findPath(c,d,t.v,t.w),a=r.path,o=r.lca,i=0,s=a[i],u=!0;e!==t.w;){if(n=c.node(e),u){for(;(s=a[i])!==o&&c.node(s).maxRank<n.rank;)i++;s===o&&(u=!1)}if(!u){for(;i<a.length-1&&c.node(s=a[i+1]).minRank<=n.rank;)i++;s=a[i]}c.setParent(e,s),e=c.successors(e)[0]}})}function findPath(e,n,t,r){for(var a,o=[],i=[],s=Math.min(n[t].low,n[r].low),u=Math.max(n[t].lim,n[r].lim),c=t;c=e.parent(c),o.push(c),c&&(n[c].low>s||u>n[c].lim););for(a=c,c=r;(c=e.parent(c))!==a;)i.push(c);return{path:o.concat(i.reverse()),lca:a}}function postorder(r){var a={},o=0;return forEach(r.children(),function e(n){var t=o;forEach(r.children(n),e),a[n]={low:t,lim:o++}}),a}function findType1Conflicts(c,e){var d={};return reduce(e,function(e,r){var o=0,i=0,s=e.length,u=last(r);return forEach(r,function(e,n){var t=findOtherInnerSegmentNode(c,e),a=t?c.node(t).order:s;!t&&e!==u||(forEach(r.slice(i,n+1),function(r){forEach(c.predecessors(r),function(e){var n=c.node(e),t=n.order;!(t<o||a<t)||n.dummy&&c.node(r).dummy||addConflict(d,e,r)})}),i=n+1,o=a)}),r}),d}function findType2Conflicts(s,e){var i={};function u(n,e,t,r,a){var o;forEach(range$1(e,t),function(e){o=n[e],s.node(o).dummy&&forEach(s.predecessors(o),function(e){var n=s.node(e);n.dummy&&(n.order<r||n.order>a)&&addConflict(i,e,o)})})}return reduce(e,function(t,r){var a,o=-1,i=0;return forEach(r,function(e,n){"border"===s.node(e).dummy&&(e=s.predecessors(e)).length&&(a=s.node(e[0]).order,u(r,i,n,o,a),i=n,o=a),u(r,i,r.length,a,t.length)}),r}),i}function findOtherInnerSegmentNode(n,e){if(n.node(e).dummy)return find$1(n.predecessors(e),function(e){return n.node(e).dummy})}function addConflict(e,n,t){t<n&&(r=n,n=t,t=r);var r=e[n];r||(e[n]=r={}),r[t]=!0}function hasConflict(e,n,t){var r;return t<n&&(r=n,n=t,t=r),has(e[n],t)}function verticalAlignment(e,n,s,u){var c={},d={},f={};return forEach(n,function(e){forEach(e,function(e,n){c[e]=e,d[e]=e,f[e]=n})}),forEach(n,function(e){var i=-1;forEach(e,function(e){var n=u(e);if(n.length)for(var t=((n=sortBy$1(n,function(e){return f[e]})).length-1)/2,r=Math.floor(t),a=Math.ceil(t);r<=a;++r){var o=n[r];d[e]===e&&i<f[o]&&!hasConflict(s,e,o)&&(d[o]=e,d[e]=c[e]=c[o],i=f[o])}})}),{root:c,align:d}}function horizontalCompaction(r,e,n,t,a){var o={},i=buildBlockGraph(r,e,n,a),s=a?"borderLeft":"borderRight";function u(e,n){for(var t=i.nodes(),r=t.pop(),a={};r;)a[r]?e(r):(a[r]=!0,t.push(r),t=t.concat(n(r))),r=t.pop()}return u(function(e){o[e]=i.inEdges(e).reduce(function(e,n){return Math.max(e,o[n.v]+i.edge(n))},0)},i.predecessors.bind(i)),u(function(e){var n=i.outEdges(e).reduce(function(e,n){return Math.min(e,o[n.w]-i.edge(n))},Number.POSITIVE_INFINITY),t=r.node(e);n!==Number.POSITIVE_INFINITY&&t.borderType!==s&&(o[e]=Math.max(o[e],n))},i.successors.bind(i)),forEach(t,function(e){o[e]=o[n[e]]}),o}function buildBlockGraph(o,e,i,n){var s=new Graph,t=o.graph(),u=sep(t.nodesep,t.edgesep,n);return forEach(e,function(e){var a;forEach(e,function(e){var n,t,r=i[e];s.setNode(r),a&&(n=i[a],t=s.edge(n,r),s.setEdge(n,r,Math.max(u(o,e,a),t||0))),a=e})}),s}function findSmallestWidthAlignment(a,e){return minBy(values(e),function(e){var t=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY;return forIn(e,function(e,n){n=width(a,n)/2;t=Math.max(e+n,t),r=Math.min(e-n,r)}),t-r})}function alignCoordinates(i,s){var e=values(s),u=min(e),c=max(e);forEach(["u","d"],function(o){forEach(["l","r"],function(e){var n,t,r=o+e,a=i[r];a!==s&&(n=values(a),(t="l"===e?u-min(n):c-max(n))&&(i[r]=mapValues(a,function(e){return e+t})))})})}function balance(t,r){return mapValues(t.ul,function(e,n){return r?t[r.toLowerCase()][n]:((n=sortBy$1(map(t,n)))[1]+n[2])/2})}function positionX(r){var a,e=buildLayerMatrix(r),o=merge(findType1Conflicts(r,e),findType2Conflicts(r,e)),i={},n=(forEach(["u","d"],function(t){a="u"===t?e:values(e).reverse(),forEach(["l","r"],function(e){"r"===e&&(a=map(a,function(e){return values(e).reverse()}));var n=("u"===t?r.predecessors:r.successors).bind(r),n=verticalAlignment(r,a,o,n),n=horizontalCompaction(r,a,n.root,n.align,"r"===e);"r"===e&&(n=mapValues(n,function(e){return-e})),i[t+e]=n})}),findSmallestWidthAlignment(r,i));return alignCoordinates(i,n),balance(i,r.graph().align)}function sep(i,s,u){return function(e,n,t){var r,a=e.node(n),o=e.node(t),n=0;if(n+=a.width/2,has(a,"labelpos"))switch(a.labelpos.toLowerCase()){case"l":r=-a.width/2;break;case"r":r=a.width/2}if(r&&(n+=u?r:-r),r=0,n=(n=(n+=(a.dummy?s:i)/2)+(o.dummy?s:i)/2)+o.width/2,has(o,"labelpos"))switch(o.labelpos.toLowerCase()){case"l":r=o.width/2;break;case"r":r=-o.width/2}return r&&(n+=u?r:-r),r=0,n}}function width(e,n){return e.node(n).width}function position(t){positionY(t=asNonCompoundGraph(t)),forOwn(positionX(t),function(e,n){t.node(n).x=e})}function positionY(t){var e=buildLayerMatrix(t),r=t.graph().ranksep,a=0;forEach(e,function(e){var n=max(map(e,function(e){return t.node(e).height}));forEach(e,function(e){t.node(e).y=a+n/2}),a+=n+r})}function layout(n,e){var t=e&&e.debugTiming?time:notime;t("layout",function(){var e=t("  buildLayoutGraph",function(){return buildLayoutGraph(n)});t("  runLayout",function(){runLayout(e,t)}),t("  updateInputGraph",function(){updateInputGraph(n,e)})})}function runLayout(e,n){n("    makeSpaceForEdgeLabels",function(){makeSpaceForEdgeLabels(e)}),n("    removeSelfEdges",function(){removeSelfEdges(e)}),n("    acyclic",function(){run$2(e)}),n("    nestingGraph.run",function(){run(e)}),n("    rank",function(){rank(asNonCompoundGraph(e))}),n("    injectEdgeLabelProxies",function(){injectEdgeLabelProxies(e)}),n("    removeEmptyRanks",function(){removeEmptyRanks(e)}),n("    nestingGraph.cleanup",function(){cleanup(e)}),n("    normalizeRanks",function(){normalizeRanks(e)}),n("    assignRankMinMax",function(){assignRankMinMax(e)}),n("    removeEdgeLabelProxies",function(){removeEdgeLabelProxies(e)}),n("    normalize.run",function(){run$1(e)}),n("    parentDummyChains",function(){parentDummyChains(e)}),n("    addBorderSegments",function(){addBorderSegments(e)}),n("    order",function(){order(e)}),n("    insertSelfEdges",function(){insertSelfEdges(e)}),n("    adjustCoordinateSystem",function(){adjust(e)}),n("    position",function(){position(e)}),n("    positionSelfEdges",function(){positionSelfEdges(e)}),n("    removeBorderNodes",function(){removeBorderNodes(e)}),n("    normalize.undo",function(){undo(e)}),n("    fixupEdgeLabelCoords",function(){fixupEdgeLabelCoords(e)}),n("    undoCoordinateSystem",function(){undo$1(e)}),n("    translateGraph",function(){translateGraph(e)}),n("    assignNodeIntersects",function(){assignNodeIntersects(e)}),n("    reversePoints",function(){reversePointsForReversedEdges(e)}),n("    acyclic.undo",function(){undo$2(e)})}function updateInputGraph(r,a){forEach(r.nodes(),function(e){var n=r.node(e),t=a.node(e);n&&(n.x=t.x,n.y=t.y,a.children(e).length&&(n.width=t.width,n.height=t.height))}),forEach(r.edges(),function(e){var n=r.edge(e),e=a.edge(e);n.points=e.points,has(e,"x")&&(n.x=e.x,n.y=e.y)}),r.graph().width=a.graph().width,r.graph().height=a.graph().height}var graphNumAttrs=["nodesep","edgesep","ranksep","marginx","marginy"],graphDefaults={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},graphAttrs=["acyclicer","ranker","rankdir","align"],nodeNumAttrs=["width","height"],nodeDefaults={width:0,height:0},edgeNumAttrs=["minlen","weight","width","height","labeloffset"],edgeDefaults={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},edgeAttrs=["labelpos"];function buildLayoutGraph(t){var r=new Graph({multigraph:!0,compound:!0}),e=canonicalize(t.graph());return r.setGraph(merge({},graphDefaults,selectNumberAttrs(e,graphNumAttrs),pick$1(e,graphAttrs))),forEach(t.nodes(),function(e){var n=canonicalize(t.node(e));r.setNode(e,defaults$1(selectNumberAttrs(n,nodeNumAttrs),nodeDefaults)),r.setParent(e,t.parent(e))}),forEach(t.edges(),function(e){var n=canonicalize(t.edge(e));r.setEdge(e,merge({},edgeDefaults,selectNumberAttrs(n,edgeNumAttrs),pick$1(n,edgeAttrs)))}),r}function makeSpaceForEdgeLabels(n){var t=n.graph();t.ranksep/=2,forEach(n.edges(),function(e){e=n.edge(e);e.minlen*=2,"c"!==e.labelpos.toLowerCase()&&("TB"===t.rankdir||"BT"===t.rankdir?e.width+=e.labeloffset:e.height+=e.labeloffset)})}function injectEdgeLabelProxies(t){forEach(t.edges(),function(e){var n=t.edge(e);n.width&&n.height&&(n=t.node(e.v),n={rank:(t.node(e.w).rank-n.rank)/2+n.rank,e:e},addDummyNode(t,"edge-proxy",n,"_ep"))})}function assignRankMinMax(n){var t=0;forEach(n.nodes(),function(e){e=n.node(e);e.borderTop&&(e.minRank=n.node(e.borderTop).rank,e.maxRank=n.node(e.borderBottom).rank,t=max(t,e.maxRank))}),n.graph().maxRank=t}function removeEdgeLabelProxies(t){forEach(t.nodes(),function(e){var n=t.node(e);"edge-proxy"===n.dummy&&(t.edge(n.e).labelRank=n.rank,t.removeNode(e))})}function translateGraph(n){var a=Number.POSITIVE_INFINITY,o=0,i=Number.POSITIVE_INFINITY,s=0,e=n.graph(),t=e.marginx||0,r=e.marginy||0;function u(e){var n=e.x,t=e.y,r=e.width,e=e.height;a=Math.min(a,n-r/2),o=Math.max(o,n+r/2),i=Math.min(i,t-e/2),s=Math.max(s,t+e/2)}forEach(n.nodes(),function(e){u(n.node(e))}),forEach(n.edges(),function(e){e=n.edge(e);has(e,"x")&&u(e)}),a-=t,i-=r,forEach(n.nodes(),function(e){e=n.node(e);e.x-=a,e.y-=i}),forEach(n.edges(),function(e){e=n.edge(e);forEach(e.points,function(e){e.x-=a,e.y-=i}),has(e,"x")&&(e.x-=a),has(e,"y")&&(e.y-=i)}),e.width=o-a+t,e.height=s-i+r}function assignNodeIntersects(o){forEach(o.edges(),function(e){var n,t=o.edge(e),r=o.node(e.v),e=o.node(e.w),a=t.points?(n=t.points[0],t.points[t.points.length-1]):(t.points=[],n=e,r);t.points.unshift(intersectRect(r,n)),t.points.push(intersectRect(e,a))})}function fixupEdgeLabelCoords(t){forEach(t.edges(),function(e){var n=t.edge(e);if(has(n,"x"))switch("l"!==n.labelpos&&"r"!==n.labelpos||(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset}})}function reversePointsForReversedEdges(n){forEach(n.edges(),function(e){e=n.edge(e);e.reversed&&e.points.reverse()})}function removeBorderNodes(o){forEach(o.nodes(),function(e){var n,t,r,a;o.children(e).length&&(e=o.node(e),n=o.node(e.borderTop),t=o.node(e.borderBottom),r=o.node(last(e.borderLeft)),a=o.node(last(e.borderRight)),e.width=Math.abs(a.x-r.x),e.height=Math.abs(t.y-n.y),e.x=r.x+e.width/2,e.y=n.y+e.height/2)}),forEach(o.nodes(),function(e){"border"===o.node(e).dummy&&o.removeNode(e)})}function removeSelfEdges(t){forEach(t.edges(),function(e){var n;e.v===e.w&&((n=t.node(e.v)).selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:e,label:t.edge(e)}),t.removeEdge(e))})}function insertSelfEdges(a){forEach(buildLayerMatrix(a),function(e){var r=0;forEach(e,function(e,n){var t=a.node(e);t.order=n+r,forEach(t.selfEdges,function(e){addDummyNode(a,"selfedge",{width:e.label.width,height:e.label.height,rank:t.rank,order:n+ ++r,e:e.e,label:e.label},"_se")}),delete t.selfEdges})})}function positionSelfEdges(i){forEach(i.nodes(),function(e){var n,t,r,a,o=i.node(e);"selfedge"===o.dummy&&(n=(a=i.node(o.e.v)).x+a.width/2,t=a.y,r=o.x-n,a=a.height/2,i.setEdge(o.e,o.label),i.removeNode(e),o.label.points=[{x:n+2*r/3,y:t-a},{x:n+5*r/6,y:t-a},{x:n+r,y:t},{x:n+5*r/6,y:t+a},{x:n+2*r/3,y:t+a}],o.label.x=o.x,o.label.y=o.y)})}function selectNumberAttrs(e,n){return mapValues(pick$1(e,n),Number)}function canonicalize(e){var t={};return forEach(e,function(e,n){t[n.toLowerCase()]=e}),t}export{Graph as G,baseClone as b,defaults$1 as d,forEach as f,has as h,isUndefined as i,layout as l,map as m,pick$1 as p,range$1 as r,uniqueId as u};