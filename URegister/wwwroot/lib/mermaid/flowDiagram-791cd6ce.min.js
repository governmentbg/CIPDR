import{p as parser$1,f as flowDb}from"./flowDb-3647b264.js";import{h as has,u as uniqueId,r as range,p as pick,l as layout,d as defaults,f as forEach,G as Graph}from"./layout-7899ed33.js";import{j as d3select,o as curveLinear,p as getStylesFromArray,q as evaluate,c as getConfig,f as common,l as log,r as interpolateToCurve,t as setupGraphViewbox}from"./mermaid-f185fde2.js";import{a as applyStyle,b as addHtmlLabel,i as isSubgraph,c as applyTransition,e as edgeToId,d as applyClass,s as selectAll,f as flowRendererV2,g as flowStyles}from"./styles-6e9ebeb4.js";import{l as line}from"./line-eb9172ee.js";import"./index-1bb7dfb9.js";import"./edges-ecd2ecb8.js";import"./createText-6836bc4a.js";import"./svgDraw-092a0897.js";import"./array-b7dcf730.js";import"./constant-b644328d.js";function responseText(e){if(e.ok)return e.text();throw new Error(e.status+" "+e.statusText)}function text(e,t){return fetch(e,t).then(responseText)}function parser(r){return(e,t)=>text(e,t).then(e=>(new DOMParser).parseFromString(e,r))}var svg=parser("image/svg+xml"),arrows={normal:normal,vee:vee,undirected:undirected};function setArrows(e){arrows=e}function normal(e,t,r,a){e=e.append("marker").attr("id",t).attr("viewBox","0 0 10 10").attr("refX",9).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",8).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M 0 0 L 10 5 L 0 10 z").style("stroke-width",1).style("stroke-dasharray","1,0");applyStyle(e,r[a+"Style"]),r[a+"Class"]&&e.attr("class",r[a+"Class"])}function vee(e,t,r,a){e=e.append("marker").attr("id",t).attr("viewBox","0 0 10 10").attr("refX",9).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",8).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M 0 0 L 10 5 L 0 10 L 4 5 z").style("stroke-width",1).style("stroke-dasharray","1,0");applyStyle(e,r[a+"Style"]),r[a+"Class"]&&e.attr("class",r[a+"Class"])}function undirected(e,t,r,a){e=e.append("marker").attr("id",t).attr("viewBox","0 0 10 10").attr("refX",9).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",8).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M 0 5 L 10 5").style("stroke-width",1).style("stroke-dasharray","1,0");applyStyle(e,r[a+"Style"]),r[a+"Class"]&&e.attr("class",r[a+"Class"])}function addSVGLabel(e,t){return e.node().appendChild(t.label),applyStyle(e,t.labelStyle),e}function addTextLabel(e,t){for(var r=e.append("text"),a=processEscapeSequences(t.label).split("\n"),n=0;n<a.length;n++)r.append("tspan").attr("xml:space","preserve").attr("dy","1em").attr("x","1").text(a[n]);return applyStyle(r,t.labelStyle),r}function processEscapeSequences(e){for(var t,r="",a=!1,n=0;n<e.length;++n)t=e[n],a?(r+="n"===t?"\n":t,a=!1):"\\"===t?a=!0:r+=t;return r}function addLabel(e,t,r){var a,n=t.label,e=e.append("g"),s=(("svg"===t.labelType?addSVGLabel:"string"!=typeof n||"html"===t.labelType?addHtmlLabel:addTextLabel)(e,t),e.node().getBBox());switch(r){case"top":a=-t.height/2;break;case"bottom":a=t.height/2-s.height;break;default:a=-s.height/2}return e.attr("transform","translate("+-s.width/2+","+a+")"),e}var createClusters=function(e,r){var t=r.nodes().filter(function(e){return isSubgraph(r,e)}),e=e.selectAll("g.cluster").data(t,function(e){return e}),t=(applyTransition(e.exit(),r).style("opacity",0).remove(),e.enter().append("g").attr("class","cluster").attr("id",function(e){return r.node(e).id}).style("opacity",0).each(function(e){var e=r.node(e),t=d3select(this);d3select(this).append("rect"),addLabel(t.append("g").attr("class","label"),e,e.clusterLabelPos)})),e=e.merge(t);return(e=applyTransition(e,r).style("opacity",1)).selectAll("rect").each(function(e){var e=r.node(e),t=d3select(this);applyStyle(t,e.style)}),e};function setCreateClusters(e){createClusters=e}let createEdgeLabels=function(e,a){var t=e.selectAll("g.edgeLabel").data(a.edges(),function(e){return edgeToId(e)}).classed("update",!0);return t.exit().remove(),t.enter().append("g").classed("edgeLabel",!0).style("opacity",0),(t=e.selectAll("g.edgeLabel")).each(function(e){var t=d3select(this),r=(t.select(".label").remove(),a.edge(e)),t=addLabel(t,a.edge(e),0).classed("label",!0),e=t.node().getBBox();r.labelId&&t.attr("id",r.labelId),has(r,"width")||(r.width=e.width),has(r,"height")||(r.height=e.height)}),e=t.exit?t.exit():t.selectAll(null),applyTransition(e,a).style("opacity",0).remove(),t};function setCreateEdgeLabels(e){createEdgeLabels=e}function intersectNode(e,t){return e.intersect(t)}var createEdgePaths=function(e,r,t){var e=e.selectAll("g.edgePath").data(r.edges(),function(e){return edgeToId(e)}).classed("update",!0),a=enter(e,r),a=(exit(e,r),void 0!==e.merge?e.merge(a):e);return applyTransition(a,r).style("opacity",1),a.each(function(e){var t=d3select(this),e=r.edge(e);e.elem=this,e.id&&t.attr("id",e.id),applyClass(t,e.class,(t.classed("update")?"update ":"")+"edgePath")}),a.selectAll("path.path").each(function(e){var t=r.edge(e),e=(t.arrowheadId=uniqueId("arrowhead"),d3select(this).attr("marker-end",function(){return"url("+makeFragmentRef(location.href,t.arrowheadId)+")"}).style("fill","none"));applyTransition(e,r).attr("d",function(e){return calcPoints(r,e)}),applyStyle(e,t.style)}),a.selectAll("defs *").remove(),a.selectAll("defs").each(function(e){e=r.edge(e);(0,t[e.arrowhead])(d3select(this),e.arrowheadId,e,"arrowhead")}),a};function setCreateEdgePaths(e){createEdgePaths=e}function makeFragmentRef(e,t){return e.split("#")[0]+"#"+t}function calcPoints(e,t){var r=e.edge(t),a=e.node(t.v),e=e.node(t.w),t=r.points.slice(1,r.points.length-1);return t.unshift(intersectNode(a,t[0])),t.push(intersectNode(e,t[t.length-1])),createLine(r,t)}function createLine(e,t){var r=(line||svg.line)().x(function(e){return e.x}).y(function(e){return e.y});return(r.curve||r.interpolate)(e.curve),r(t)}function getCoords(e){var t=e.getBBox(),e=e.ownerSVGElement.getScreenCTM().inverse().multiply(e.getScreenCTM()).translate(t.width/2,t.height/2);return{x:e.e,y:e.f}}function enter(e,a){e=e.enter().append("g").attr("class","edgePath").style("opacity",0);return e.append("path").attr("class","path").attr("d",function(e){var t=a.edge(e),r=a.node(e.v).elem;return createLine(t,range(t.points.length).map(function(){return getCoords(r)}))}),e.append("defs"),e}function exit(e,t){e=e.exit();applyTransition(e,t).style("opacity",0).remove()}var createNodes=function(e,s,i){var t=s.nodes().filter(function(e){return!isSubgraph(s,e)}),t=e.selectAll("g.node").data(t,function(e){return e}).classed("update",!0);return t.exit().remove(),t.enter().append("g").attr("class","node").style("opacity",0),(t=e.selectAll("g.node")).each(function(e){var e=s.node(e),t=d3select(this),r=(applyClass(t,e.class,(t.classed("update")?"update ":"")+"node"),t.select("g.label").remove(),t.append("g").attr("class","label")),a=addLabel(r,e),n=i[e.shape],a=pick(a.node().getBBox(),"width","height"),t=(e.elem=this,e.id&&t.attr("id",e.id),e.labelId&&r.attr("id",e.labelId),has(e,"width")&&(a.width=e.width),has(e,"height")&&(a.height=e.height),a.width+=e.paddingLeft+e.paddingRight,a.height+=e.paddingTop+e.paddingBottom,r.attr("transform","translate("+(e.paddingLeft-e.paddingRight)/2+","+(e.paddingTop-e.paddingBottom)/2+")"),d3select(this)),r=(t.select(".label-container").remove(),n(t,a,e).classed("label-container",!0)),n=(applyStyle(r,e.style),r.node().getBBox());e.width=n.width,e.height=n.height}),e=t.exit?t.exit():t.selectAll(null),applyTransition(e,s).style("opacity",0).remove(),t};function setCreateNodes(e){createNodes=e}function positionClusters(e,t){var r=e.filter(function(){return!d3select(this).classed("update")});function a(e){e=t.node(e);return"translate("+e.x+","+e.y+")"}r.attr("transform",a),applyTransition(e,t).style("opacity",1).attr("transform",a),applyTransition(r.selectAll("rect"),t).attr("width",function(e){return t.node(e).width}).attr("height",function(e){return t.node(e).height}).attr("x",function(e){return-t.node(e).width/2}).attr("y",function(e){return-t.node(e).height/2})}function positionEdgeLabels(e,t){function r(e){e=t.edge(e);return has(e,"x")?"translate("+e.x+","+e.y+")":""}e.filter(function(){return!d3select(this).classed("update")}).attr("transform",r),applyTransition(e,t).style("opacity",1).attr("transform",r)}function positionNodes(e,t){function r(e){e=t.node(e);return"translate("+e.x+","+e.y+")"}e.filter(function(){return!d3select(this).classed("update")}).attr("transform",r),applyTransition(e,t).style("opacity",1).attr("transform",r)}function intersectEllipse(e,t,r,a){var n=e.x,e=e.y,s=n-a.x,i=e-a.y,o=Math.sqrt(t*t*i*i+r*r*s*s),s=Math.abs(t*r*s/o),t=(a.x<n&&(s=-s),Math.abs(t*r*i/o));return{x:n+s,y:e+(t=a.y<e?-t:t)}}function intersectCircle(e,t,r){return intersectEllipse(e,t,t,r)}function intersectLine(e,t,r,a){var n,s=t.y-e.y,i=e.x-t.x,o=t.x*e.y-e.x*t.y,l=s*r.x+i*r.y+o,d=s*a.x+i*a.y+o;if(!(0!=l&&0!=d&&sameSign(l,d)||(l=a.y-r.y,d=r.x-a.x,r=a.x*r.y-r.x*a.y,a=l*e.x+d*e.y+r,e=l*t.x+d*t.y+r,0!=a&&0!=e&&sameSign(a,e)||0==(n=s*d-l*i))))return t=Math.abs(n/2),{x:(a=i*r-d*o)<0?(a-t)/n:(a+t)/n,y:(a=l*o-s*r)<0?(a-t)/n:(a+t)/n}}function sameSign(e,t){return 0<e*t}function intersectPolygon(e,t,a){for(var r=e.x,n=e.y,s=[],i=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY,l=(t.forEach(function(e){i=Math.min(i,e.x),o=Math.min(o,e.y)}),r-e.width/2-i),d=n-e.height/2-o,c=0;c<t.length;c++){var h=t[c],p=t[c<t.length-1?c+1:0],h=intersectLine(e,a,{x:l+h.x,y:d+h.y},{x:l+p.x,y:d+p.y});h&&s.push(h)}return s.length?(1<s.length&&s.sort(function(e,t){var r=e.x-a.x,e=e.y-a.y,r=Math.sqrt(r*r+e*e),e=t.x-a.x,t=t.y-a.y,e=Math.sqrt(e*e+t*t);return r<e?-1:r===e?0:1}),s[0]):(console.log("NO INTERSECTION FOUND, RETURN NODE CENTER",e),e)}function intersectRect(e,t){var r,a=e.x,n=e.y,s=t.x-a,t=t.y-n,i=e.width/2,e=e.height/2,e=Math.abs(t)*i>Math.abs(s)*e?(t<0&&(e=-e),r=0==t?0:e*s/t,e):(r=i=s<0?-i:i,0==s?0:i*t/s);return{x:a+r,y:n+e}}var shapes={rect:rect,ellipse:ellipse,circle:circle,diamond:diamond};function setShapes(e){shapes=e}function rect(e,t,r){e=e.insert("rect",":first-child").attr("rx",r.rx).attr("ry",r.ry).attr("x",-t.width/2).attr("y",-t.height/2).attr("width",t.width).attr("height",t.height);return r.intersect=function(e){return intersectRect(r,e)},e}function ellipse(e,t,r){var a=t.width/2,n=t.height/2,e=e.insert("ellipse",":first-child").attr("x",-t.width/2).attr("y",-t.height/2).attr("rx",a).attr("ry",n);return r.intersect=function(e){return intersectEllipse(r,a,n,e)},e}function circle(e,t,r){var a=Math.max(t.width,t.height)/2,e=e.insert("circle",":first-child").attr("x",-t.width/2).attr("y",-t.height/2).attr("r",a);return r.intersect=function(e){return intersectCircle(r,a,e)},e}function diamond(e,t,r){var a=t.width*Math.SQRT2/2,t=t.height*Math.SQRT2/2,n=[{x:0,y:-t},{x:-a,y:0},{x:0,y:t},{x:a,y:0}],t=e.insert("polygon",":first-child").attr("points",n.map(function(e){return e.x+","+e.y}).join(" "));return r.intersect=function(e){return intersectPolygon(r,n,e)},t}function render(){function t(e,t){preProcessGraph(t);var e=createOrSelectGroup(e,"output"),r=createOrSelectGroup(e,"clusters"),a=createOrSelectGroup(e,"edgePaths"),n=createEdgeLabels(createOrSelectGroup(e,"edgeLabels"),t),e=createNodes(createOrSelectGroup(e,"nodes"),t,shapes);layout(t),positionNodes(e,t),positionEdgeLabels(n,t),createEdgePaths(a,t,arrows),positionClusters(createClusters(r,t),t),postProcessGraph(t)}return t.createNodes=function(e){return arguments.length?(setCreateNodes(e),t):createNodes},t.createClusters=function(e){return arguments.length?(setCreateClusters(e),t):createClusters},t.createEdgeLabels=function(e){return arguments.length?(setCreateEdgeLabels(e),t):createEdgeLabels},t.createEdgePaths=function(e){return arguments.length?(setCreateEdgePaths(e),t):createEdgePaths},t.shapes=function(e){return arguments.length?(setShapes(e),t):shapes},t.arrows=function(e){return arguments.length?(setArrows(e),t):arrows},t}var NODE_DEFAULT_ATTRS={paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10,rx:0,ry:0,shape:"rect"},EDGE_DEFAULT_ATTRS={arrowhead:"normal",curve:curveLinear};function preProcessGraph(r){r.nodes().forEach(function(e){var t=r.node(e);has(t,"label")||r.children(e).length||(t.label=e),has(t,"paddingX")&&defaults(t,{paddingLeft:t.paddingX,paddingRight:t.paddingX}),has(t,"paddingY")&&defaults(t,{paddingTop:t.paddingY,paddingBottom:t.paddingY}),has(t,"padding")&&defaults(t,{paddingLeft:t.padding,paddingRight:t.padding,paddingTop:t.padding,paddingBottom:t.padding}),defaults(t,NODE_DEFAULT_ATTRS),forEach(["paddingLeft","paddingRight","paddingTop","paddingBottom"],function(e){t[e]=Number(t[e])}),has(t,"width")&&(t._prevWidth=t.width),has(t,"height")&&(t._prevHeight=t.height)}),r.edges().forEach(function(e){e=r.edge(e);has(e,"label")||(e.label=""),defaults(e,EDGE_DEFAULT_ATTRS)})}function postProcessGraph(t){forEach(t.nodes(),function(e){e=t.node(e);has(e,"_prevWidth")?e.width=e._prevWidth:delete e.width,has(e,"_prevHeight")?e.height=e._prevHeight:delete e.height,delete e._prevWidth,delete e._prevHeight})}function createOrSelectGroup(e,t){var r=e.select("g."+t);return r=r.empty()?e.append("g").attr("class",t):r}function question(e,t,r){t=.9*(t.width+t.height);const a=[{x:t/2,y:0},{x:t,y:-t/2},{x:t/2,y:-t},{x:0,y:-t/2}];e=insertPolygonShape(e,t,t,a);return r.intersect=function(e){return intersectPolygon(r,a,e)},e}function hexagon(e,t,r){var a=t.height,n=a/4,t=t.width+2*n;const s=[{x:n,y:0},{x:t-n,y:0},{x:t,y:-a/2},{x:t-n,y:-a},{x:n,y:-a},{x:0,y:-a/2}];n=insertPolygonShape(e,t,a,s);return r.intersect=function(e){return intersectPolygon(r,s,e)},n}function rect_left_inv_arrow(e,t,r){var a=t.width,t=t.height;const n=[{x:-t/2,y:0},{x:a,y:0},{x:a,y:-t},{x:-t/2,y:-t},{x:0,y:-t/2}];e=insertPolygonShape(e,a,t,n);return r.intersect=function(e){return intersectPolygon(r,n,e)},e}function lean_right(e,t,r){var a=t.width,t=t.height;const n=[{x:-2*t/6,y:0},{x:a-t/6,y:0},{x:a+2*t/6,y:-t},{x:t/6,y:-t}];e=insertPolygonShape(e,a,t,n);return r.intersect=function(e){return intersectPolygon(r,n,e)},e}function lean_left(e,t,r){var a=t.width,t=t.height;const n=[{x:2*t/6,y:0},{x:a+t/6,y:0},{x:a-2*t/6,y:-t},{x:-t/6,y:-t}];e=insertPolygonShape(e,a,t,n);return r.intersect=function(e){return intersectPolygon(r,n,e)},e}function trapezoid(e,t,r){var a=t.width,t=t.height;const n=[{x:-2*t/6,y:0},{x:a+2*t/6,y:0},{x:a-t/6,y:-t},{x:t/6,y:-t}];e=insertPolygonShape(e,a,t,n);return r.intersect=function(e){return intersectPolygon(r,n,e)},e}function inv_trapezoid(e,t,r){var a=t.width,t=t.height;const n=[{x:t/6,y:0},{x:a-t/6,y:0},{x:a+2*t/6,y:-t},{x:-2*t/6,y:-t}];e=insertPolygonShape(e,a,t,n);return r.intersect=function(e){return intersectPolygon(r,n,e)},e}function rect_right_inv_arrow(e,t,r){var a=t.width,t=t.height;const n=[{x:0,y:0},{x:a+t/2,y:0},{x:a,y:-t/2},{x:a+t/2,y:-t},{x:0,y:-t}];e=insertPolygonShape(e,a,t,n);return r.intersect=function(e){return intersectPolygon(r,n,e)},e}function stadium(e,t,r){var a=t.height,t=t.width+a/4,e=e.insert("rect",":first-child").attr("rx",a/2).attr("ry",a/2).attr("x",-t/2).attr("y",-a/2).attr("width",t).attr("height",a);return r.intersect=function(e){return intersectRect(r,e)},e}function subroutine(e,t,r){var a=t.width,t=t.height;const n=[{x:0,y:0},{x:a,y:0},{x:a,y:-t},{x:0,y:-t},{x:0,y:0},{x:-8,y:0},{x:a+8,y:0},{x:a+8,y:-t},{x:-8,y:-t},{x:-8,y:0}];e=insertPolygonShape(e,a,t,n);return r.intersect=function(e){return intersectPolygon(r,n,e)},e}function cylinder(e,t,n){var r=t.width;const s=r/2,i=s/(2.5+r/50);var t=t.height+i,a="M 0,"+i+" a "+s+","+i+" 0,0,0 "+r+" 0 a "+s+","+i+" 0,0,0 "+-r+" 0 l 0,"+t+" a "+s+","+i+" 0,0,0 "+r+" 0 l 0,"+-t,e=e.attr("label-offset-y",i).insert("path",":first-child").attr("d",a).attr("transform","translate("+-r/2+","+-(t/2+i)+")");return n.intersect=function(t){const r=intersectRect(n,t);var a=r.x-n.x;if(0!=s&&(Math.abs(a)<n.width/2||Math.abs(a)==n.width/2&&Math.abs(r.y-n.y)>n.height/2-i)){let e=i*i*(1-a*a/(s*s));0!=e&&(e=Math.sqrt(e)),e=i-e,0<t.y-n.y&&(e=-e),r.y+=e}return r},e}function addToRender(e){e.shapes().question=question,e.shapes().hexagon=hexagon,e.shapes().stadium=stadium,e.shapes().subroutine=subroutine,e.shapes().cylinder=cylinder,e.shapes().rect_left_inv_arrow=rect_left_inv_arrow,e.shapes().lean_right=lean_right,e.shapes().lean_left=lean_left,e.shapes().trapezoid=trapezoid,e.shapes().inv_trapezoid=inv_trapezoid,e.shapes().rect_right_inv_arrow=rect_right_inv_arrow}function addToRenderV2(e){e({question:question}),e({hexagon:hexagon}),e({stadium:stadium}),e({subroutine:subroutine}),e({cylinder:cylinder}),e({rect_left_inv_arrow:rect_left_inv_arrow}),e({lean_right:lean_right}),e({lean_left:lean_left}),e({trapezoid:trapezoid}),e({inv_trapezoid:inv_trapezoid}),e({rect_right_inv_arrow:rect_right_inv_arrow})}function insertPolygonShape(e,t,r,a){return e.insert("polygon",":first-child").attr("points",a.map(function(e){return e.x+","+e.y}).join(" ")).attr("transform","translate("+-t/2+","+r/2+")")}const flowChartShapes={addToRender:addToRender,addToRenderV2:addToRenderV2},conf={},setConf=function(e){for(const t of Object.keys(e))conf[t]=e[t]},addVertices=function(h,p,e,t,r,u){const g=t?t.select(`[id="${e}"]`):d3select(`[id="${e}"]`),f=r||document,a=Object.keys(h);a.forEach(function(e){const t=h[e];let r="default";0<t.classes.length&&(r=t.classes.join(" "));const a=getStylesFromArray(t.styles);let n=void 0!==t.text?t.text:t.id,s;if(evaluate(getConfig().flowchart.htmlLabels)){e={label:n.replace(/fa[blrs]?:fa-[\w-]+/g,e=>`<i class='${e.replace(":"," ")}'></i>`)};(s=addHtmlLabel(g,e).node()).parentNode.removeChild(s)}else{const l=f.createElementNS("http://www.w3.org/2000/svg","text");l.setAttribute("style",a.labelStyle.replace("color:","fill:"));for(const d of n.split(common.lineBreakRegex)){const c=f.createElementNS("http://www.w3.org/2000/svg","tspan");c.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),c.setAttribute("dy","1em"),c.setAttribute("x","1"),c.textContent=d,l.appendChild(c)}s=l}let i=0,o="";switch(t.type){case"round":i=5,o="rect";break;case"square":o="rect";break;case"diamond":o="question";break;case"hexagon":o="hexagon";break;case"odd":o="rect_left_inv_arrow";break;case"lean_right":o="lean_right";break;case"lean_left":o="lean_left";break;case"trapezoid":o="trapezoid";break;case"inv_trapezoid":o="inv_trapezoid";break;case"odd_right":o="rect_left_inv_arrow";break;case"circle":o="circle";break;case"ellipse":o="ellipse";break;case"stadium":o="stadium";break;case"subroutine":o="subroutine";break;case"cylinder":o="cylinder";break;default:o="rect"}log.warn("Adding node",t.id,t.domId),p.setNode(u.db.lookUpDomId(t.id),{labelType:"svg",labelStyle:a.labelStyle,shape:o,label:s,rx:i,ry:i,class:r,style:a.style,id:u.db.lookUpDomId(t.id)})})},addEdges=function(l,d,c){let h=0,p,u;var e;void 0!==l.defaultStyle&&(e=getStylesFromArray(l.defaultStyle),p=e.style,u=e.labelStyle),l.forEach(function(e){h++;var t="L-"+e.start+"-"+e.end,r="LS-"+e.start,a="LE-"+e.end;const n={};"arrow_open"===e.type?n.arrowhead="none":n.arrowhead="normal";let s="",i="";if(void 0!==e.style){var o=getStylesFromArray(e.style);s=o.style,i=o.labelStyle}else switch(e.stroke){case"normal":s="fill:none",void 0!==p&&(s=p),void 0!==u&&(i=u);break;case"dotted":s="fill:none;stroke-width:2px;stroke-dasharray:3;";break;case"thick":s=" stroke-width: 3.5px;fill:none"}n.style=s,n.labelStyle=i,void 0!==e.interpolate?n.curve=interpolateToCurve(e.interpolate,curveLinear):void 0!==l.defaultInterpolate?n.curve=interpolateToCurve(l.defaultInterpolate,curveLinear):n.curve=interpolateToCurve(conf.curve,curveLinear),void 0===e.text?void 0!==e.style&&(n.arrowheadStyle="fill: #333"):(n.arrowheadStyle="fill: #333",n.labelpos="c",evaluate(getConfig().flowchart.htmlLabels)?(n.labelType="html",n.label=`<span id="L-${t}" class="edgeLabel L-${r}' L-${a}" style="${n.labelStyle}">${e.text.replace(/fa[blrs]?:fa-[\w-]+/g,e=>`<i class='${e.replace(":"," ")}'></i>`)}</span>`):(n.labelType="text",n.label=e.text.replace(common.lineBreakRegex,"\n"),void 0===e.style&&(n.style=n.style||"stroke: #333; stroke-width: 1.5px;fill:none"),n.labelStyle=n.labelStyle.replace("color:","fill:"))),n.id=t,n.class=r+" "+a,n.minlen=e.length||1,d.setEdge(c.db.lookUpDomId(e.start),c.db.lookUpDomId(e.end),n,h)})},getClasses=function(e,t){return log.info("Extracting classes"),t.db.getClasses()},draw=function(e,o,t,l){log.info("Drawing flowchart");const{securityLevel:d,flowchart:r}=getConfig();let a;"sandbox"===d&&(a=d3select("#i"+o));const c="sandbox"===d?d3select(a.nodes()[0].contentDocument.body):d3select("body"),h="sandbox"===d?a.nodes()[0].contentDocument:document;let n=l.db.getDirection();void 0===n&&(n="TD");var s=r.nodeSpacing||50,i=r.rankSpacing||50;const p=new Graph({multigraph:!0,compound:!0}).setGraph({rankdir:n,nodesep:s,ranksep:i,marginx:8,marginy:8}).setDefaultEdgeLabel(function(){return{}});let u;var g=l.db.getSubGraphs();for(let e=g.length-1;0<=e;e--)u=g[e],l.db.addVertex(u.id,u.title,"group",void 0,u.classes);const f=l.db.getVertices();log.warn("Get vertices",f);s=l.db.getEdges();let y=0;for(y=g.length-1;0<=y;y--){u=g[y],selectAll("cluster").append("text");for(let e=0;e<u.nodes.length;e++)log.warn("Setting subgraph",u.nodes[e],l.db.lookUpDomId(u.nodes[e]),l.db.lookUpDomId(u.id)),p.setParent(l.db.lookUpDomId(u.nodes[e]),l.db.lookUpDomId(u.id))}addVertices(f,p,o,c,h,l),addEdges(s,p,l);const b=new render;flowChartShapes.addToRender(b),b.arrows().none=function(e,t,r,a){const n=e.append("marker").attr("id",t).attr("viewBox","0 0 10 10").attr("refX",9).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",8).attr("markerHeight",6).attr("orient","auto");e=n.append("path").attr("d","M 0 0 L 0 0 L 0 0 z");applyStyle(e,r[a+"Style"])},b.arrows().normal=function(e,t){const r=e.append("marker").attr("id",t).attr("viewBox","0 0 10 10").attr("refX",9).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",8).attr("markerHeight",6).attr("orient","auto");r.append("path").attr("d","M 0 0 L 10 5 L 0 10 z").attr("class","arrowheadPath").style("stroke-width",1).style("stroke-dasharray","1,0")};i=c.select(`[id="${o}"]`);const w=c.select("#"+o+" g");for(b(w,p),w.selectAll("g.node").attr("title",function(){return l.db.getTooltip(this.id)}),l.db.indexNodes("subGraph"+y),y=0;y<g.length;y++)if("undefined"!==(u=g[y]).title){var x=h.querySelectorAll("#"+o+' [id="'+l.db.lookUpDomId(u.id)+'"] rect');const _=h.querySelectorAll("#"+o+' [id="'+l.db.lookUpDomId(u.id)+'"]');var m=x[0].x.baseVal.value,v=x[0].y.baseVal.value,x=x[0].width.baseVal.value;const T=d3select(_[0]),L=T.select(".label");L.attr("transform",`translate(${m+x/2}, ${v+14})`),L.attr("id",o+"Text");for(let e=0;e<u.classes.length;e++)_[0].classList.add(u.classes[e])}if(!r.htmlLabels)for(const E of h.querySelectorAll('[id="'+o+'"] .edgeLabel .label')){var S=E.getBBox();const C=h.createElementNS("http://www.w3.org/2000/svg","rect");C.setAttribute("rx",0),C.setAttribute("ry",0),C.setAttribute("width",S.width),C.setAttribute("height",S.height),E.insertBefore(C,E.firstChild)}setupGraphViewbox(p,i,r.diagramPadding,r.useMaxWidth);const k=Object.keys(f);k.forEach(function(e){const t=f[e];if(t.link){const r=c.select("#"+o+' [id="'+l.db.lookUpDomId(e)+'"]');if(r){const a=h.createElementNS("http://www.w3.org/2000/svg","a"),n=(a.setAttributeNS("http://www.w3.org/2000/svg","class",t.classes.join(" ")),a.setAttributeNS("http://www.w3.org/2000/svg","href",t.link),a.setAttributeNS("http://www.w3.org/2000/svg","rel","noopener"),"sandbox"===d?a.setAttributeNS("http://www.w3.org/2000/svg","target","_top"):t.linkTarget&&a.setAttributeNS("http://www.w3.org/2000/svg","target",t.linkTarget),r.insert(function(){return a},":first-child")),s=r.select(".label-container"),i=(s&&n.append(function(){return s.node()}),r.select(".label"));i&&n.append(function(){return i.node()})}}})},flowRenderer={setConf:setConf,addVertices:addVertices,addEdges:addEdges,getClasses:getClasses,draw:draw},diagram={parser:parser$1,db:flowDb,renderer:flowRendererV2,styles:flowStyles,init:e=>{e.flowchart||(e.flowchart={}),e.flowchart.arrowMarkerAbsolute=e.arrowMarkerAbsolute,flowRenderer.setConf(e.flowchart),flowDb.clear(),flowDb.setGen("gen-1")}};export{diagram};